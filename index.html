<!DOCTYPE html>
<html lang="fr">
    <head>
        <meta charset="utf-8"/>
        <meta content="width=device-width, initial-scale=1" name="viewport"/>
        <title>Vaccination collÃ¨ge â€“ Ãle-de-France</title>
        <meta name="description" content="Site officiel dâ€™information de lâ€™Ã‰quipe Mobile de Vaccination (EMV) â€“ Campagne de vaccination en milieu scolaire (collÃ¨ges) en Ãle-de-France. Ressources sanitaires, documents officiels et informations Ã  destination des familles et des Ã©tablissements."/>
        <meta name="keywords" content="vaccination, collÃ¨ge, santÃ© publique, Ã©quipe mobile de vaccination, EMV, HPV, mÃ©ningite, ARS, Ã©ducation nationale"/>
        <meta name="author" content="Ã‰quipe Mobile de Vaccination â€“ SantÃ© publique"/>
        <meta name="robots" content="index, follow"/>
        <meta name="category" content="Health"/>
        <meta name="classification" content="Public Health Information"/>
        <meta name="audience" content="Families, Educational institutions, Health professionals"/>
        <style>:root { --bg: #f5f7fb; --card: #ffffff; --text: #111827; --muted: #6b7280; --border: #e5e7eb; --primary: #2563eb; --primary-soft: #e0e7ff; --accent: #16a34a; --accent-soft: #dcfce7; --btn: #ffffff; } [data-theme="dark"] { --bg: #141c2f;  /* fond gÃ©nÃ©ral un peu plus clair */ --card: #1a2238;  /* cartes lÃ©gÃ¨rement relevÃ©es */ --text: #e5e7eb; --muted: #9ca3af; --border: #1f2937; --primary: #38bdf8; --primary-soft: #0c4a6e; --accent: #22c55e; --accent-soft: #052e1b; --btn: #020617; } body { background: var(--bg); color: var(--text); } .card, details, .search, .select { background: var(--card); color: var(--text); border-color: var(--border); } summary { color: var(--text); } .ans { color: #d1d5db; } .chip, .tag { background: #020617; border-color: var(--border); color: #cbd5f5; } .langBtn { background: #020617; color: var(--text); border-color: var(--border); } .langBtn.active { background: var(--primary-soft); color: #e0f2fe; } .navItem:hover { background: #020617; border-color: rgba(56,189,248,.25); } .navItem.active { background: var(--primary-soft); border-color: rgba(56,189,248,.35); } .btn.primary { background: var(--primary); border-color: rgba(56,189,248,.45); } .btn.soft { background: var(--accent-soft); border-color: rgba(34,197,94,.35); color: #bbf7d0; } * { box-sizing: border-box; } body { margin: 0; font-family: var(--font); color: var(--text); background: var(--bg); } a { color: inherit; } .layout { display: flex; min-height: 100vh; } /* Sidebar */.sidebar { width: var(--sidebar); padding: 18px 14px; position: sticky; top: 0; height: 100vh; overflow: auto; border-right: 1px solid var(--border); background: linear-gradient(180deg, #ffffff 0%, #fbfcff 100%); } .brand { display: flex; align-items: center; gap: 10px; padding: 10px 10px 14px 10px; } .brandMark { width: 36px; height: 36px; border-radius: 12px; background: var(--primary-soft); display: grid; place-items: center; color: var(--primary); font-weight: 800; border: 1px solid rgba(47,91,255,.18); } .brandName { font-weight: 800; letter-spacing: .2px; } .navTitle { margin: 8px 10px 8px; font-size: 12px; letter-spacing: .08em; text-transform: uppercase; color: var(--muted); } .navList { display: flex; flex-direction: column; gap: 6px; padding: 0 6px 16px; } .navItem { border: 1px solid transparent; padding: 10px 10px; border-radius: 12px; cursor: pointer; color: #1f2937; display: flex; align-items: center; justify-content: space-between; gap: 10px; } .navItem:hover { background: #f4f7ff; border-color: rgba(47,91,255,.14); } .navItem.active { background: var(--primary-soft); border-color: rgba(47,91,255,.22); } .chip { font-size: 12px; padding: 2px 8px; border-radius: 999px; background: #f3f4f6; color: #374151; border: 1px solid var(--border); white-space: nowrap; } .footNote { padding: 12px 10px; color: var(--muted); font-size: 12px; border-top: 1px solid var(--border); margin-top: 10px; } /* Main */.main { flex: 1; padding: 18px; } .topbar { max-width: var(--max); margin: 0 auto 14px; display: flex; align-items: center; justify-content: space-between; gap: 12px; } .rightBar { display: flex; align-items: center; gap: 10px; flex-wrap: wrap; justify-content: center; } /* ===== FIX CENTRAGE LANGUES DANS TOPBAR ===== */.topbar { justify-content: center !important; } .burger { position: absolute; left: 18px; } .rightBar { justify-content: center; } .search { display: flex; align-items: center; gap: 10px; padding: 10px 12px; border: 1px solid var(--border); border-radius: 12px; background: #fff; min-width: 260px; } .search input { border: none; outline: none; width: 100%; font-size: 14px; } .container { max-width: var(--max); margin: 0 auto; } .hero { display: block; margin-bottom: 16px; } .card { background: var(--card); border: 1px solid var(--border); border-radius: var(--radius); box-shadow: var(--shadow); } .heroText { padding: 22px; } .kicker { display: inline-flex; align-items: center; gap: 8px; padding: 8px 12px; border-radius: 999px; background: var(--primary-soft); color: var(--primary); font-weight: 800; border: 1px solid rgba(47,91,255,.18); font-size: 12px; letter-spacing: .02em; } h1 { margin: 12px 0 10px; font-size: 46px; line-height: 1.08; letter-spacing: -.02em; } h1 .accent { color: var(--accent); } .subtitle { margin: 0; color: var(--muted); font-size: 16px; line-height: 1.55; max-width: 62ch; } .btnRow { display: flex; gap: 10px; flex-wrap: wrap; margin-top: 16px; } .btn { display: inline-flex; align-items: center; justify-content: center; padding: 10px 14px; border-radius: 999px; border: 1px solid var(--border); background: #fff; text-decoration: none; font-weight: 800; font-size: 13px; cursor: pointer; transition: transform .05s ease; } .btn:hover { transform: translateY(-1px); } .btn.primary { background: var(--primary); border-color: rgba(47,91,255,.45); color: #fff; } .btn.soft { background: var(--accent-soft); border-color: rgba(255,138,0,.22); color: #7a3a00; } .heroArt { padding: 18px; position: relative; overflow: hidden; } .artBox { height: 100%; border-radius: 16px; background: radial-gradient(circle at 20% 20%, rgba(47,91,255,.15), transparent 45%),
                  radial-gradient(circle at 70% 30%, rgba(255,138,0,.18), transparent 55%),
                  linear-gradient(180deg, #ffffff 0%, #f6f8ff 100%); border: 1px solid rgba(17,24,39,.06); display: flex; align-items: center; justify-content: center; position: relative; min-height: 240px; } .artLabel { position: absolute; bottom: 14px; left: 14px; right: 14px; padding: 10px 12px; border-radius: 14px; background: rgba(255,255,255,.85); border: 1px solid rgba(17,24,39,.08); color: var(--muted); font-size: 12px; } .logoImg { height: 38px; max-width: 220px; object-fit: contain; filter: drop-shadow(0 2px 6px rgba(0,0,0,.12)); margin-bottom: 10px; } /* Sections */.grid { display: grid; grid-template-columns: 1fr; gap: 16px; } .sectionHead { padding: 18px 20px 0; } .sectionTitle { margin: 0; font-size: 16px; font-weight: 900; letter-spacing: .2px; } .sectionDesc { margin: 6px 0 0; color: var(--muted); font-size: 13px; line-height: 1.5; } .sectionBody { padding: 14px 20px 20px; } .resourceGroup { display: flex; flex-wrap: wrap; gap: 10px; } .note { margin-top: 10px; color: var(--muted); font-size: 12px; line-height: 1.55; white-space: pre-wrap; } /* FAQ */.faqMeta { display: flex; align-items: flex-start; justify-content: space-between; gap: 10px; flex-wrap: wrap; } .faqTitle { margin: 0; font-size: 18px; font-weight: 900; } .faqCount { color: var(--muted); font-size: 12px; margin-top: 6px; } .accordion { display: flex; flex-direction: column; gap: 10px; margin-top: 12px; } details { background: #fff; border: 1px solid var(--border); border-radius: 14px; padding: 12px 14px; } summary { cursor: pointer; list-style: none; font-weight: 850; display: flex; align-items: center; justify-content: space-between; gap: 10px; } summary::-webkit-details-marker { display: none; } .ans { color: #374151; font-size: 14px; line-height: 1.6; margin-top: 10px; white-space: pre-wrap; } .tagRow { display: flex; gap: 8px; flex-wrap: wrap; margin-top: 8px; } .tag { font-size: 12px; padding: 2px 8px; border-radius: 999px; background: #f3f4f6; border: 1px solid var(--border); color: #374151; } /* Mobile */.burger { display: none; padding: 10px 12px; border: 1px solid var(--border); border-radius: 12px; background: #fff; font-weight: 800; cursor: pointer; } @media (max-width: 980px){ .hero {  grid-template-columns: 1fr; }  h1 {  font-size: 38px; }  .sidebar {  position: fixed;  left: -320px;  top: 0;  bottom: 0;  z-index: 50;  transition: left .2s ease; }  .sidebar.open {  left: 0; }  .burger {  display: inline-flex; }  .search {  min-width: 200px; } } /* ===== UI adjustments (no sidebar, no search) ===== */.sidebar { display: none !important; } .burger { display: none !important; } .search { display: none !important; } .layout { grid-template-columns: 1fr !important; } .main { padding-left: 0 !important; } .select { padding: 12px 16px !important; border-radius: 14px !important; font-size: 15px !important; min-width: 180px; } /* ===== RTL languages support (Arabic, Pashto, Kurdish) ===== */.rtl { direction: rtl; text-align: right; } .rtl .hero, .rtl .card, .rtl .sectionBody, .rtl .sectionTitle, .rtl .sectionDesc, .rtl p, .rtl li, .rtl .faqQ, .rtl .faqA { text-align: right; } /* Language buttons */.langButtons { display: flex; gap: 8px; flex-wrap: wrap; justify-content: center; align-items: center; } .langBtn { border: 1px solid rgba(0,0,0,.12); background: #fff; color: var(--text); padding: 8px 10px; border-radius: 999px; cursor: pointer; font-size: 13px; font-weight: 700; line-height: 1; display: flex; gap: 6px; align-items: center; } .langBtn:hover { box-shadow: 0 2px 10px rgba(0,0,0,.08); } .langBtn.active { background: var(--primary-light); border-color: rgba(0,95,115,.35); } /* ===============================
   THEME FIX â€“ A COLLER ICI
   =============================== */body { background: var(--bg); color: var(--text); } .card, details, .search, .select { background: var(--card) !important; color: var(--text) !important; border: 1px solid var(--border) !important; } summary { color: var(--text) !important; } .ans { color: var(--text) !important; } .btn { background: var(--btn) !important; color: var(--text) !important; border-color: var(--border) !important; } .btn.primary { background: var(--primary) !important; color: #ffffff !important; } .btn.soft { background: var(--accent-soft) !important; color: var(--accent) !important; } .chip, .tag { background: var(--primary-soft) !important; color: var(--text) !important; border-color: var(--border) !important; } details[open] { border-color: var(--primary) !important; } .artBox { background: linear-gradient(
    180deg,
    var(--card) 0%,
    var(--bg) 100%
  ) !important; } /* ===== BANDE LOGOS INSTITUTIONNELS ===== */.institutional-logos { display: flex; justify-content: center; align-items: center; gap: 32px; height: 90px;  /* â‰ˆ 5â€“6 cm */ padding: 10px 20px; background: var(--bg); border-bottom: 1px solid var(--border); } .institutional-logos img { max-height: 70px; width: auto; object-fit: contain; } /* ===== RESPONSIVE LOGOS â€“ MOBILE ===== */@media (max-width: 768px) { .institutional-logos {  flex-wrap: wrap;   /* autorise le retour Ã  la ligne */  height: auto;   /* supprime la contrainte fixe */  gap: 16px;  padding: 12px 10px; }  .institutional-logos img {  max-height: 48px;   /* logos plus petits sur mobile */  max-width: 45%; } } /* ===== FIX LANG BUTTONS â€“ DARK MODE ===== */[data-theme="dark"] .langBtn { background: var(--card) !important; color: var(--text) !important; border-color: var(--border) !important; } [data-theme="dark"] .langBtn.active { background: var(--primary) !important; color: #ffffff !important; } /* ===== CONTACT SECTION WIDE ===== */.contactWide { padding-top: 20px; } .contactGrid { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 14px; } .contactItem { display: flex; align-items: center; gap: 12px; padding: 14px 16px; border-radius: 16px; background: var(--card); border: 1px solid var(--border); color: var(--text); text-decoration: none; font-weight: 700; transition: background .15s ease, transform .05s ease; } .contactItem:hover { background: var(--primary-soft); transform: translateY(-1px); } .contactIcon { font-size: 20px; } .contactText { line-height: 1.35; } /* ===== SCHÃ‰MA : Vaccination en 3 Ã©tapes ===== */.stepsContainer { display: flex; flex-direction: column; gap: 14px; } .stepItem { display: flex; align-items: flex-start; gap: 14px; padding: 16px; border-radius: 16px; background: var(--card); border: 1px solid var(--border); } /* ===== VISIBILITÃ‰ FORCÃ‰E DES Ã‰TAPES ===== */.stepItem { background: var(--card) !important; opacity: 1 !important; } .stepItem:hover { background: var(--primary-soft); cursor: pointer; } .stepNumber { width: 36px; height: 36px; border-radius: 999px; background: var(--primary); color: #fff; font-weight: 900; display: flex; align-items: center; justify-content: center; flex-shrink: 0; } .stepTitle { font-weight: 900; font-size: 15px; margin-bottom: 4px; } .stepText { font-size: 13px; line-height: 1.5; color: var(--muted); } /* ===== AFFICHAGE DES BOUTONS PAR Ã‰TAPE ===== */.stepActions { margin-top: 12px; padding: 14px; border-radius: 14px; background: var(--card); border: 1px solid var(--border); } .stepActions .resourceGroup { display: flex; flex-wrap: wrap; gap: 10px; } /* ===== HERO CENTRÃ‰ (titre, texte, boutons) ===== */.heroText { text-align: center; } .heroText .btnRow { justify-content: center; } .heroText .kicker { margin-left: auto; margin-right: auto; } /* ===== HERO : centrage du sous-titre ===== */#heroSubtitle { text-align: center; margin-left: auto; margin-right: auto; max-width: 70ch; } /* ===== MASQUAGE DES BOUTONS DANS INTRO ===== */#introBody .resourceGroup, #introBody .btn { display: none !important; } /* ===== MASQUAGE TITRE MÃ‰NINGITE DANS INTRO ===== */#introBody > div[style*="font-weight"] { display: none !important; } /* ===== PULSE VISUEL DES Ã‰TAPES (INCITATION AU CLIC) ===== */.stepItem { position: relative; transition: box-shadow 0.3s ease, transform 0.3s ease; } .stepItem.pulse { box-shadow: 0 0 0 0 rgba(56, 189, 248, 0.6); animation: stepPulse 1.2s ease-out; } @keyframes stepPulse { 0% {  box-shadow: 0 0 0 0 rgba(56, 189, 248, 0.6);  transform: scale(1); }  60% {  box-shadow: 0 0 0 10px rgba(56, 189, 248, 0);  transform: scale(1.015); }  100% {  box-shadow: 0 0 0 0 rgba(56, 189, 248, 0);  transform: scale(1); } } /* ===== AJUSTEMENT MOBILE ===== */@media (max-width: 768px) { .stepItem.pulse {  animation-duration: 1.4s; } } /* ===== FIX TAILLE + POSITION ICONES Ã‰TAPES ===== */.stepItem { display: flex; align-items: flex-start; gap: 14px; } .stepIllustration { width: 56px; height: 56px; min-width: 56px; max-width: 56px; object-fit: contain; flex-shrink: 0; }
.stepIllustration {
  width: 56px;
  height: 56px;
  min-width: 56px;
  max-width: 56px;
  object-fit: contain;
  flex-shrink: 0;
}

/* ===== AUTORISER LA BARRE DE RECHERCHE PLANNING ===== */
#scheduleSearchSection .search {
  display: flex !important;
}
/* ===== BARRE DE RECHERCHE PLANNING â€“ STYLE PILULE ===== */
#scheduleSearchSection .search {
  padding: 16px 22px !important;
  border-radius: 999px !important;
  min-height: 56px;
  box-shadow: 0 4px 14px rgba(0,0,0,0.06);
}

#scheduleSearchSection .search input {
  font-size: 16px;
  padding: 6px 0;
}

/* ===== MASQUAGE TEMPORAIRE DU TOGGLE THÃˆME ===== */
#themeToggle {
  display: none !important;
}
/* ===== FIX LANG BUTTONS â€“ LIGHT MODE ===== */
[data-theme="light"] .langBtn {
  background: #ffffff;
  color: #111827;            /* texte lisible */
  border-color: var(--border);
}

[data-theme="light"] .langBtn.active {
  background: var(--primary-soft); /* fond bleu clair */
  color: var(--primary);           /* TEXTE BLEU FONCÃ‰ â†’ lisible */
  font-weight: 900;
}
/* ===== FIX NUMÃ‰ROS TÃ‰LÃ‰PHONE EN RTL ===== */
.rtl .contactItem,
.rtl .contactItem * {
  direction: ltr !important;
  unicode-bidi: isolate;
  text-align: left;
}

</style>
        <link href="../../Documents/Pinegrow%20Projects/Tailwind-CSS-20260203-211032/tailwind_theme/tailwind.css" rel="stylesheet" type="text/css">
    </head>
    <body>
        <!-- ===== BANDE LOGOS INSTITUTIONNELS ===== -->
        <div class="institutional-logos">
            <img src="img/ARS.png" alt="Agence RÃ©gionale de SantÃ© Ãle-de-France">
            <img src="img/AM.png" alt="Assurance Maladie">
            <img src="img/CHMELUN.png" alt="Groupe Hospitalier de Melun">
            <img src="img/EMV.png" alt="Ã‰quipe Mobile de Vaccination">
        </div>
        <!-- ===== FIN BANDE LOGOS ===== -->
        <div class="layout">
            <aside class="sidebar" id="sidebar">
                <div class="brand">
                    <div class="brandMark">V</div>
                    <div>
                        <div class="brandName">Vaccination CollÃ¨ge</div>
                        <div style="color:var(--muted);font-size:12px;margin-top:2px">HPV â€¢ MÃ©ningite ACWY â€¢ Rappels</div>
                    </div>
                </div>
                <div class="navTitle">Sections</div>
                <div class="navList" id="navList"></div>
                <div class="footNote" id="sideFooter">
                    Astuce : utilisez la recherche pour trouver rapidement une rÃ©ponse.
</div>
            </aside>
            <main class="main">
                <div class="topbar container">
                    <button class="burger" id="burgerBtn">â˜° Menu</button>
                    <div class="rightBar">
                        <div class="search" title="Rechercher dans la FAQ">
                            ğŸ” 

                            <input id="searchInput" placeholder="Rechercherâ€¦" type="search"/>
                        </div>
                        <div aria-label="Langue" class="langButtons" id="langButtons"></div>
                        <button id="themeToggle" class="btn" title="Mode clair / sombre">ğŸŒ™</button>
                    </div>
                </div>
                <div class="container">
                    <section class="hero">
                        <div class="card heroText">
                            <h1 id="heroTitle">Vaccination <span class="accent">collÃ¨ge</span><br/>Ãle-de-France</h1>
                            <p class="subtitle" id="heroSubtitle">
              AccÃ©dez aux informations essentielles, aux documents et Ã  la FAQ. Lâ€™inscription se fait en quelques clics. </p>
                            <div class="btnRow" id="heroBtns"></div>
                        </div>
                    </section>
                </div>
<!-- ===== RECHERCHE DATE DE VACCINATION COLLÃˆGE ===== -->
<section class="container" id="scheduleSearchSection" style="margin-bottom:24px;">
  <div class="card" style="padding:20px;">
    <div style="display:flex;gap:20px;align-items:center;flex-wrap:wrap;">

      <!-- Consigne multilingue -->
      <div id="scheduleHint"
           style="flex:1;min-width:240px;color:var(--muted);font-size:14px;line-height:1.5;">
        <!-- Texte injectÃ© via JS selon la langue -->
      </div>

      <!-- Barre de recherche -->
      <div class="search" style="flex:1;min-width:260px;">
        ğŸ”
        <input
          type="search"
          id="scheduleSearchInput"
          autocomplete="off"
        />
      </div>

    </div>

    <!-- RÃ©sultats -->
    <div id="scheduleResults" style="margin-top:16px;display:none;"></div>
  </div>
</section>
<!-- ===== FIN RECHERCHE ===== -->

                <section class="card" id="stepsCard" style="margin-bottom:16px;">
                    <div class="sectionHead">
                        <div class="sectionTitle" id="stepsTitle"></div>
                        <div class="sectionDesc" id="stepsSubtitle"></div>
                    </div>
                    <div class="sectionBody">
                        <div class="stepsContainer" id="stepsContainer"></div>
                    </div>
                </section>
                <div class="grid">
                    <section class="card" id="introCard">
                        <div class="sectionHead">
                            <div class="sectionTitle" id="introTitle">Message &amp; ressources</div>
                            <div class="sectionDesc" id="introDesc">Documents officiels, formulaires et vidÃ©os.</div>
                        </div>
                        <div class="sectionBody" id="introBody"></div>
                    </section>
                    <section class="card" id="faqCard">
                        <div class="sectionHead">
                            <div class="faqMeta">
                                <div>
                                    <div class="faqTitle" id="faqTitle">FAQ</div>
                                    <div class="faqCount" id="faqCount"></div>
                                </div>
                                <div class="tagRow" id="activeFilters"></div>
                            </div>
                        </div>
                        <div class="sectionBody">
                            <div class="accordion" id="faqList"></div>
                        </div>
                    </section>
                    <section class="card" id="contactCard" style="margin-top:16px;">
                        <div class="sectionHead">
                            <div class="sectionTitle" id="contactTitle">Nous contacter</div>
                            <div class="sectionDesc" id="contactDesc">Adresse, tÃ©lÃ©phone et email.</div>
                        </div>
                        <div class="sectionBody contactWide">
                            <div class="contactGrid">
                                <!-- Adresse -->
                                <a class="contactItem" href="https://maps.app.goo.gl/zGLgVufgVPTTqRAg8" target="_blank" rel="noopener" title="Ouvrir dans Google Maps"> <span class="contactIcon">ğŸ“</span> <span class="contactText">
        8 Rue de Vaux<br/>
        77000 Melun </span> </a>
                                <!-- TÃ©lÃ©phone 1 -->
                                <a class="contactItem" href="tel:0181742850"> <span class="contactIcon">â˜ï¸</span> <span class="contactText">01 81 74 28 50</span> </a>
                                <!-- TÃ©lÃ©phone 2 -->
                                <a class="contactItem" href="tel:0181743247"> <span class="contactIcon">â˜ï¸</span> <span class="contactText">01 81 74 32 47</span> </a>
                                <!-- Email -->
                                <a class="contactItem" href="mailto:vaccin-hpv@ghsif.fr"> <span class="contactIcon">âœ‰ï¸</span> <span class="contactText">vaccin-hpv@ghsif.fr</span> </a>
                            </div>
                        </div>
                    </section>
                </div>
            </main>
        </div>
        <script>
  const FAQ_URL = './faq.json';
  const INTRO_URL = './intro_resources.json';

  const els = {
    sidebar: document.getElementById('sidebar'),
    burgerBtn: document.getElementById('burgerBtn'),
    navList: document.getElementById('navList'),
    langButtons: document.getElementById('langButtons'),
    searchInput: document.getElementById('searchInput'),
    heroBtns: document.getElementById('heroBtns'),
    introBody: document.getElementById('introBody'),
    faqTitle: document.getElementById('faqTitle'),
    faqCount: document.getElementById('faqCount'),
    faqList: document.getElementById('faqList'),
    activeFilters: document.getElementById('activeFilters'),
    heroKicker: document.getElementById('heroKicker'),
    heroTitle: document.getElementById('heroTitle'),
    heroSubtitle: document.getElementById('heroSubtitle'),
    introTitle: document.getElementById('introTitle'),
    introDesc: document.getElementById('introDesc'),
    contactTitle: document.getElementById('contactTitle'),
    contactDesc: document.getElementById('contactDesc'),
  };

  let faqData = null;
  let introData = null;
  let lang = 'fr';
  let activeSection = 'all';

  const safeText = (v) => (v ?? '').toString();

  const normPath = (p) => {
    if(!p) return p;
    // On GitHub Pages (project pages), absolute paths like /img/... break.
    // So we normalize to relative paths.
    return (typeof p === 'string' && p.startsWith('/')) ? p.slice(1) : p;
  };

  const t = (obj, fallback='') => {
    if(!obj) return fallback;
    return obj[lang] || obj.fr || obj.en || Object.values(obj)[0] || fallback;
  };

  // Static UI texts that are not stored in JSON
  const UI_TEXT = {
    heroKicker: {
      fr: "Informations & inscription",
      en: "Information & registration",
      ar: "Ù…Ø¹Ù„ÙˆÙ…Ø§Øª ÙˆØ§Ù„ØªØ³Ø¬ÙŠÙ„",
      tr: "Bilgi ve kayÄ±t",
      ps: "Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ùˆ Ø«Ø¨Øª Ù†Ø§Ù…",
      ku: "Ø²Ø§Ù†ÛŒØ§Ø±ÛŒ Ùˆ ØªÛ†Ù…Ø§Ø±Ú©Ø±Ø¯Ù†",
      ro: "InformaÈ›ii È™i Ã®nscriere",
      ka: "áƒ˜áƒœáƒ¤áƒáƒ áƒ›áƒáƒªáƒ˜áƒ áƒ“áƒ áƒ áƒ”áƒ’áƒ˜áƒ¡áƒ¢áƒ áƒáƒªáƒ˜áƒ"
    },
    heroTitleHtml: {
      fr: "Vaccination <span class=\"accent\">collÃ¨ge</span><br/>Ãle-de-France",
      en: "School <span class=\"accent\">vaccination</span><br/>Ãle-de-France",
      ar: "Ø§Ù„ØªÙ„Ù‚ÙŠØ­ <span class=\"accent\">ÙÙŠ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯ÙŠØ©</span><br/>Ãle-de-France",
      tr: "Okul <span class=\"accent\">aÅŸÄ±lamasÄ±</span><br/>Ãle-de-France",
      ps: "Ø¯ ÚšÙˆÙˆÙ†ÚÙŠ <span class=\"accent\">ÙˆØ§Ú©Ø³ÛŒÙ†</span><br/>Ãle-de-France",
      ku: "Ú¤Ø§Ú©Ø³ÛŒÙ†ÛŒ <span class=\"accent\">Ù‚ÙˆØªØ§Ø¨Ø®Ø§Ù†Û•</span><br/>Ãle-de-France",
      ro: "Vaccinare <span class=\"accent\">la colegiu</span><br/>Ãle-de-France",
      ka: "áƒ¡áƒ™áƒáƒšáƒ˜áƒ¡ <span class=\"accent\">áƒ•áƒáƒ¥áƒªáƒ˜áƒœáƒáƒªáƒ˜áƒ</span><br/>Ãle-de-France"
    },
    heroSubtitle: {
  fr: "Une information claire et fiable pour accompagner les familles dans la vaccination au collÃ¨ge. DÃ©couvrez les documents officiels, les rÃ©ponses aux questions frÃ©quentes et les modalitÃ©s dâ€™inscription.",
  en: "Clear and reliable information to support families with school vaccination. Access official documents, answers to common questions and registration details.",
  ar: "Ù…Ø¹Ù„ÙˆÙ…Ø§Øª ÙˆØ§Ø¶Ø­Ø© ÙˆÙ…ÙˆØ«ÙˆÙ‚Ø© Ù„Ù…Ø±Ø§ÙÙ‚Ø© Ø§Ù„Ø¹Ø§Ø¦Ù„Ø§Øª ÙÙŠ Ø§Ù„ØªÙ„Ù‚ÙŠØ­ Ø§Ù„Ù…Ø¯Ø±Ø³ÙŠ. Ø§Ø·Ù‘Ù„Ø¹ Ø¹Ù„Ù‰ Ø§Ù„ÙˆØ«Ø§Ø¦Ù‚ Ø§Ù„Ø±Ø³Ù…ÙŠØ©ØŒ ÙˆØ§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª Ø¹Ù† Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø´Ø§Ø¦Ø¹Ø©ØŒ ÙˆØ·Ø±ÙŠÙ‚Ø© Ø§Ù„ØªØ³Ø¬ÙŠÙ„.",
  tr: "Okul aÅŸÄ±lamasÄ±nda ailelere yÃ¶nelik aÃ§Ä±k ve gÃ¼venilir bilgiler. ResmÃ® belgelere, sÄ±k sorulan sorulara ve kayÄ±t bilgilerine ulaÅŸÄ±n.",
  ps: "Ù¾Ù‡ ÚšÙˆÙˆÙ†ÚÙŠ Ú©Û Ø¯ ÙˆØ§Ú©Ø³ÛŒÙ† Ù¾Ù‡ Ø§Ú“Ù‡ Ø¯ Ú©ÙˆØ±Ù†ÛŒÙˆ Ù„Ù¾Ø§Ø±Ù‡ Ø±ÙˆÚšØ§Ù†Ù‡ Ø§Ùˆ Ø¨Ø§ÙˆØ±ÙŠ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª. Ø±Ø³Ù…ÙŠ Ø§Ø³Ù†Ø§Ø¯ØŒ Ø¹Ø§Ù…Ùˆ Ù¾ÙˆÚšØªÙ†Ùˆ ÚÙˆØ§Ø¨ÙˆÙ†Ù‡ Ø§Ùˆ Ø¯ Ù†ÙˆÙ…â€ŒÙ„ÛŒÚ©Ù†Û Ú…Ø±Ù†Ú«ÙˆØ§Ù„ÛŒ ÙˆÚ«ÙˆØ±Ø¦.",
  ku: "Ø²Ø§Ù†ÛŒØ§Ø±ÛŒÛŒ Ú•ÙˆÙˆÙ† Ùˆ Ø¨Ø§ÙˆÛ•Ú•Ù¾ÛÚ©Ø±Ø§Ùˆ Ø¨Û† Ù‡Ø§ÙˆÚ©Ø§Ø±ÛŒÛŒ Ø®ÛØ²Ø§Ù†Û•Ú©Ø§Ù† Ù„Û• Ú¤Ø§Ú©Ø³ÛŒÙ†ÛŒ Ù‚ÙˆØªØ§Ø¨Ø®Ø§Ù†Û•. Ø¯Û•Ø³ØªÚ¯Û•ÛŒØ´ØªÙ† Ø¨Û• Ø¨Û•ÚµÚ¯Û•Ù†Ø§Ù…Û• ÙÛ•Ø±Ù…ÛŒÛŒÛ•Ú©Ø§Ù†ØŒ Ù¾Ø±Ø³ÛŒØ§Ø±Û• Ø¨Ø§ÙˆÛ•Ú©Ø§Ù† Ùˆ Ø²Ø§Ù†ÛŒØ§Ø±ÛŒÛŒ ØªÛ†Ù…Ø§Ø±Ú©Ø±Ø¯Ù†.",
  ro: "InformaÈ›ii clare È™i de Ã®ncredere pentru a sprijini familiile Ã®n vaccinarea È™colarÄƒ. AccesaÈ›i documentele oficiale, rÄƒspunsurile la Ã®ntrebÄƒrile frecvente È™i detaliile de Ã®nscriere.",
  ka: "áƒ›áƒ™áƒáƒ¤áƒ˜áƒ áƒ“áƒ áƒ¡áƒáƒœáƒ“áƒ áƒ˜áƒœáƒ¤áƒáƒ áƒ›áƒáƒªáƒ˜áƒ áƒáƒ¯áƒáƒ®áƒ”áƒ‘áƒ˜áƒ¡ áƒ›áƒ®áƒáƒ áƒ“áƒáƒ¡áƒáƒ­áƒ”áƒ áƒáƒ“ áƒ¡áƒ™áƒáƒšáƒ˜áƒ¡ áƒ•áƒáƒ¥áƒªáƒ˜áƒœáƒáƒªáƒ˜áƒáƒ¨áƒ˜. áƒ’áƒáƒ”áƒªáƒáƒœáƒ˜áƒ— áƒáƒ¤áƒ˜áƒªáƒ˜áƒáƒšáƒ£áƒ  áƒ“áƒáƒ™áƒ£áƒ›áƒ”áƒœáƒ¢áƒ”áƒ‘áƒ¡, áƒ®áƒ¨áƒ˜áƒ áƒáƒ“ áƒ“áƒáƒ¡áƒ›áƒ£áƒš áƒ™áƒ˜áƒ—áƒ®áƒ•áƒ”áƒ‘áƒ¡ áƒ“áƒ áƒ áƒ”áƒ’áƒ˜áƒ¡áƒ¢áƒ áƒáƒªáƒ˜áƒ˜áƒ¡ áƒáƒ˜áƒ áƒáƒ‘áƒ”áƒ‘áƒ¡."
},
introTitle: {
  fr: "Ã‰quipe Mobile de Vaccination â€“ Sud Seine-et-Marne",
  en: "Mobile Vaccination Team â€“ Southern Seine-et-Marne",
  ar: "Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ù…ØªÙ†Ù‚Ù„ Ù„Ù„ØªÙ„Ù‚ÙŠØ­ â€“ Ø¬Ù†ÙˆØ¨ Ø³ÙŠÙ†-Ø¥ÙŠ-Ù…Ø§Ø±Ù†",
  tr: "Mobil AÅŸÄ±lama Ekibi â€“ GÃ¼ney Seine-et-Marne",
  ps: "Ø¯ ÙˆØ§Ú©Ø³ÛŒÙ† Ú«Ø±ÚÙ†Ø¯Ù‡ Ù¼ÛŒÙ… â€“ Ø¬Ù†ÙˆØ¨ÙŠ Ø³ÛŒÙ†-Ø§Û-Ù…Ø§Ø±Ù†",
  ku: "TÃ®ma VakisÃ®nasyona Gerok â€“ BaÅŸÃ»rÃª Seine-et-Marne",
  ro: "Echipa MobilÄƒ de Vaccinare â€“ Sud Seine-et-Marne",
  ka: "áƒ›áƒáƒ‘áƒ˜áƒšáƒ£áƒ áƒ˜ áƒ•áƒáƒ¥áƒªáƒ˜áƒœáƒáƒªáƒ˜áƒ˜áƒ¡ áƒ’áƒ£áƒœáƒ“áƒ˜ â€“ áƒ¡áƒáƒ›áƒ®áƒ áƒ”áƒ—áƒ˜ áƒ¡áƒ”áƒœ-áƒ”-áƒ›áƒáƒ áƒœáƒ˜"
},
    "introDesc": {
  "fr": "UnitÃ© de santÃ© publique du Groupe Hospitalier de Melun, chargÃ©e de lâ€™organisation et de la coordination de la vaccination en milieu scolaire (collÃ¨ges).",
  "en": "Public health unit of the Melun Hospital Group, responsible for organizing and coordinating school-based vaccination in middle schools.",
  "ar": "ÙˆØ­Ø¯Ø© Ù„Ù„ØµØ­Ø© Ø§Ù„Ø¹Ø§Ù…Ø© ØªØ§Ø¨Ø¹Ø© Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© Ù…Ø³ØªØ´ÙÙŠØ§Øª Ù…ÙŠÙ„ÙˆÙ†ØŒ Ù…Ø³Ø¤ÙˆÙ„Ø© Ø¹Ù† ØªÙ†Ø¸ÙŠÙ… ÙˆØªÙ†Ø³ÙŠÙ‚ Ø§Ù„ØªÙ„Ù‚ÙŠØ­ ÙÙŠ Ø§Ù„ÙˆØ³Ø· Ø§Ù„Ù…Ø¯Ø±Ø³ÙŠ (Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯ÙŠ).",
  "tr": "Melun Hastane Grubuâ€™na baÄŸlÄ± bir halk saÄŸlÄ±ÄŸÄ± birimi olup ortaokullarda yÃ¼rÃ¼tÃ¼len aÅŸÄ±lamanÄ±n organizasyonu ve koordinasyonundan sorumludur.",
  "ps": "Ø¯ Ù…ÛÙ„ÙˆÙ† Ø¯ Ø±ÙˆØºØªÙˆÙ† Ú‰Ù„Û Ø¯ Ø¹Ø§Ù…Û Ø±ÙˆØºØªÛŒØ§ ÙˆØ§Ø­Ø¯ØŒ Ú†Û Ù¾Ù‡ Ù…Ù†ÚÙ†ÛŒÙˆ ÚšÙˆÙˆÙ†ÚÛŒÙˆ Ú©Û Ø¯ ÙˆØ§Ú©Ø³ÛŒÙ† Ú©ÙˆÙ„Ùˆ Ø¯ ØªÙ†Ø¸ÛŒÙ… Ø§Ùˆ Ù‡Ù…ØºÚ–Û Ù…Ø³Ø¤Ù„ÛŒØª Ù„Ø±ÙŠ.",
  "ku": "YekÃ®neya tenduristiya giÅŸtÃ® ya Koma NexweÅŸxaneya MelunÃª, ku berpirsiyar e ji bo rÃªxistin Ã» hevrÃªziya vakÃ®sÃ®na li dibistanÃªn navÃ®n.",
  "ro": "Unitate de sÄƒnÄƒtate publicÄƒ a Grupului Spitalicesc din Melun, responsabilÄƒ de organizarea È™i coordonarea vaccinÄƒrii Ã®n mediul È™colar (colegii).",
  "ka": "áƒ›áƒ”áƒšáƒ£áƒœáƒ˜áƒ¡ áƒ°áƒáƒ¡áƒáƒ˜áƒ¢áƒáƒšáƒ£áƒ áƒ˜ áƒ¯áƒ’áƒ£áƒ¤áƒ˜áƒ¡ áƒ¡áƒáƒ–áƒáƒ’áƒáƒ“áƒáƒ”áƒ‘áƒ áƒ˜áƒ•áƒ˜ áƒ¯áƒáƒœáƒ›áƒ áƒ—áƒ”áƒšáƒáƒ‘áƒ˜áƒ¡ áƒ”áƒ áƒ—áƒ”áƒ£áƒšáƒ˜, áƒ áƒáƒ›áƒ”áƒšáƒ˜áƒª áƒáƒáƒ¡áƒ£áƒ®áƒ˜áƒ¡áƒ›áƒ’áƒ”áƒ‘áƒ”áƒšáƒ˜áƒ áƒ™áƒáƒšáƒ”áƒ¯áƒ”áƒ‘áƒ¨áƒ˜ áƒ•áƒáƒ¥áƒªáƒ˜áƒœáƒáƒªáƒ˜áƒ˜áƒ¡ áƒáƒ áƒ’áƒáƒœáƒ˜áƒ–áƒ”áƒ‘áƒáƒ¡áƒ áƒ“áƒ áƒ™áƒáƒáƒ áƒ“áƒ˜áƒœáƒáƒªáƒ˜áƒáƒ–áƒ”."
},
    contactTitle: {
      fr: "Nous contacter",
      en: "Contact us",
      ar: "Ø§ØªØµÙ„ Ø¨Ù†Ø§",
      tr: "Bize ulaÅŸÄ±n",
      ps: "Ù…ÙˆÚ– Ø³Ø±Ù‡ Ø§Ú“ÛŒÚ©Ù‡",
      ku: "Ù¾Û•ÛŒÙˆÛ•Ù†Ø¯ÛŒ Ù¾ÛÙˆÛ• Ø¨Ú©Û•",
      ro: "Contact",
      ka: "áƒ“áƒáƒ’áƒ•áƒ˜áƒ™áƒáƒ•áƒ¨áƒ˜áƒ áƒ“áƒ˜áƒ—"
    },
    contactDesc: {
      fr: "Adresse, tÃ©lÃ©phone et email.",
      en: "Address, phone and email.",
      ar: "Ø§Ù„Ø¹Ù†ÙˆØ§Ù† ÙˆØ§Ù„Ù‡Ø§ØªÙ ÙˆØ§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ.",
      tr: "Adres, telefon ve e-posta.",
      ps: "Ù¾ØªÙ‡ØŒ Ù¼ÛŒÙ„ÛŒÙÙˆÙ† Ø§Ùˆ Ø¨Ø±ÛÚšÙ†Ø§Ù„ÛŒÚ©.",
      ku: "Ù†Ø§ÙˆÙ†ÛŒØ´Ø§Ù†ØŒ ØªÛ•Ù„Û•ÙÛ†Ù† Ùˆ Ø¦ÛŒÙ…Û•ÛŒÚµ.",
      ro: "AdresÄƒ, telefon È™i e-mail.",
      ka: "áƒ›áƒ˜áƒ¡áƒáƒ›áƒáƒ áƒ—áƒ˜, áƒ¢áƒ”áƒšáƒ”áƒ¤áƒáƒœáƒ˜ áƒ“áƒ áƒ”áƒšáƒ¤áƒáƒ¡áƒ¢áƒ."
    },
    searchTitle: {
      fr: "Rechercher dans la FAQ",
      en: "Search the FAQ",
      ar: "Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø´Ø§Ø¦Ø¹Ø©",
      tr: "SSS'de ara",
      ps: "Ù¾Ù‡ FAQ Ú©Û Ù„Ù¼ÙˆÙ†",
      ku: "Ú¯Û•Ú•Ø§Ù† Ù„Û• FAQ",
      ro: "CautÄƒ Ã®n FAQ",
      ka: "áƒ«áƒ˜áƒ”áƒ‘áƒ FAQ-áƒ¨áƒ˜"
    },
    searchPlaceholder: {
      fr: "Rechercherâ€¦",
      en: "Searchâ€¦",
      ar: "Ø§Ø¨Ø­Ø«â€¦",
      tr: "Araâ€¦",
      ps: "ÙˆÙ„Ù¼ÙˆØ¦â€¦",
      ku: "Ø¨Ú¯Û•Ú•Ûâ€¦",
      ro: "CautÄƒâ€¦",
      ka: "áƒ«áƒ˜áƒ”áƒ‘áƒâ€¦"
    }
  };

  const applyStaticTexts = () => {
    if(els.heroKicker) els.heroKicker.textContent = t(UI_TEXT.heroKicker, els.heroKicker.textContent || '');
    if(els.heroTitle)  els.heroTitle.innerHTML   = t(UI_TEXT.heroTitleHtml, els.heroTitle.innerHTML || '');
    if(els.heroSubtitle) els.heroSubtitle.textContent = t(UI_TEXT.heroSubtitle, els.heroSubtitle.textContent || '');
    if(els.introTitle) els.introTitle.textContent = t(UI_TEXT.introTitle, els.introTitle.textContent || '');
    if(els.introDesc)  els.introDesc.textContent  = t(UI_TEXT.introDesc, els.introDesc.textContent || '');
    if(els.contactTitle) els.contactTitle.textContent = t(UI_TEXT.contactTitle, els.contactTitle.textContent || '');
    if(els.contactDesc)  els.contactDesc.textContent  = t(UI_TEXT.contactDesc, els.contactDesc.textContent || '');

    // Search UI
    const searchWrap = document.querySelector('.search');
    if(searchWrap) searchWrap.title = t(UI_TEXT.searchTitle, searchWrap.title || '');
    if(els.searchInput){
      els.searchInput.placeholder = t(UI_TEXT.searchPlaceholder, els.searchInput.placeholder || '');
    }
  };


 const makeBtn = (label, href, cls='btn', key=null) => {
  const a = document.createElement('a');
  a.className = cls;
  a.href = href;

  if (key) a.dataset.key = key;   // âœ… CLÃ‰ TECHNIQUE STABLE

  const isLocalPdf = (typeof href === 'string')
    && (/\.pdf(\?|#|$)/i.test(href))
    && !/^https?:\/\//i.test(href);

  const isMail = typeof href === 'string' && href.startsWith('mailto:');

if (isMail) {
  a.target = '_self';          // âœ… indispensable
} 
else if (isLocalPdf) {
  if (key === 'calendar_full') {
    a.dataset.downloadName = 'Les vaccins Ã  tous les Ã¢ges.pdf';
  }
  a.target = '_self';
}

else {
  a.target = '_blank';
  a.rel = 'noopener';
}


  a.textContent = label;
  return a;
};


  function buildLangButtons(){
    if(!els.langButtons) return;
    els.langButtons.innerHTML = '';
    const langs = (faqData?.meta?.languages) || ['fr'];
    const labels = faqData?.meta?.lang_labels || {};
    const flags = { fr:'ğŸ‡«ğŸ‡·', en:'ğŸ‡¬ğŸ‡§', ar:'ğŸ‡¸ğŸ‡¦', tr:'ğŸ‡¹ğŸ‡·', ps:'ğŸ‡¦ğŸ‡«', ku:'ğŸ‡®ğŸ‡¶', ka:'ğŸ‡¬ğŸ‡ª', ro:'ğŸ‡·ğŸ‡´' };
    langs.forEach(l => {
      const b = document.createElement('button');
      b.type = 'button';
      b.className = 'langBtn' + (l===lang ? ' active' : '');
      b.dataset.lang = l;
      b.innerHTML = `<span aria-hidden="true">${flags[l]||'ğŸŒ'}</span><span>${labels[l] || l}</span>`;
      b.addEventListener('click', () => setLanguage(l));
      els.langButtons.appendChild(b);
    });
  }

  function setLanguage(newLang){
  lang = newLang;
  applyDirection();
  applyStaticTexts();
  buildSidebar();
  renderHero();
  renderIntro();
  renderSteps();
  renderFAQ();
  buildLangButtons();

  // âœ… RELANCE DU CYCLE
  requestAnimationFrame(() => {
    setTimeout(startStepPulse, 800);
  });
}


  function buildSidebar(){
    const sections = faqData?.sections || [];
    const items = faqData?.items || [];
    const counts = {};
    items.forEach(it => { counts[it.section] = (counts[it.section]||0)+1; });

    const allLabel = (lang === 'fr') ? 'Tout' :
                     (lang === 'en') ? 'All' :
                     (lang === 'ar') ? 'Ø§Ù„ÙƒÙ„' :
                     (lang === 'tr') ? 'TÃ¼mÃ¼' :
                     (lang === 'ps') ? 'Ù¼ÙˆÙ„' :
                     (lang === 'ku') ? 'HemÃ»' :
                     (lang === 'ro') ? 'Toate' :
                     (lang === 'ka') ? 'áƒ§áƒ•áƒ”áƒšáƒ' : 'All';



    els.navList.innerHTML = '';
    const all = document.createElement('div');
    all.className = 'navItem' + (activeSection==='all'?' active':'');
    all.onclick = () => { activeSection='all'; renderFAQ(); buildSidebar(); };
    all.innerHTML = `<span>${allLabel}</span><span class="chip">${items.length}</span>`;
    els.navList.appendChild(all);

    sections.forEach(sec => {
      const id = sec.key || sec.id;
      const label = t(sec.title, id);
      const row = document.createElement('div');
      row.className = 'navItem' + (activeSection===id?' active':'');
      row.onclick = () => { activeSection=id; renderFAQ(); buildSidebar(); };
      row.innerHTML = `<span>${label}</span><span class="chip">${counts[id]||0}</span>`;
      els.navList.appendChild(row);
    });
  }

  function renderHero(){
    els.heroBtns.innerHTML = '';

    // Keep: official IDF website
    const idfUrl = introData?.official_idf?.site?.url;
    const idfLabel = t(introData?.official_idf?.site?.label, 'Site officiel â€“ Vaccination CollÃ¨ge Ãle-de-France');
    if(idfUrl){
      els.heroBtns.appendChild(makeBtn(idfLabel, idfUrl, 'btn'));
    }

    // Add: 3 key videos next to the official site
    const vids = (introData?.resources?.videos || []).slice(0,3);
    vids.forEach(v => {
      /* âœ… FIX VIDEO LABEL: title first, then label */
      const label = t(v.title, '') || t(v.label, 'VidÃ©o');
      if(v?.url) els.heroBtns.appendChild(makeBtn(label, v.url, 'btn'));
    });
  }



  function renderIntro(){
    const root = els.introBody;
    root.innerHTML = '';

    // Logo if available
    const logoFile = null;

    const logoAlt = t(introData?.branding?.service_logo?.alt || introData?.branding?.logo?.alt, 'Logo');
    if(logoFile){
      const img = document.createElement('img');
      img.src = logoFile;
      img.alt = logoAlt;
      img.className = 'logoImg';
      root.appendChild(img);
    }

    // Intro text
    const introBlock = introData?.intro;
    if(introBlock){
      const title = document.createElement('div');
      title.style.fontWeight = '900';
      title.style.fontSize = '16px';
      title.textContent = t(introBlock.title, 'Introduction');
      root.appendChild(title);

      const body = document.createElement('div');
      body.className = 'note';
      body.style.fontSize = '13px';
      body.style.color = 'var(--text)';
      body.textContent = t(introBlock.body, '') || t(introBlock.text, '');
      root.appendChild(body);

      const sig = (typeof introBlock.signature === 'string') ? introBlock.signature : t(introBlock.signature, '');
      if(sig){
        const s = document.createElement('div');
        s.className = 'note';
        s.textContent = sig;
        root.appendChild(s);
      }

    }

    const group = document.createElement('div');
    group.className = 'resourceGroup';
    root.appendChild(group);

    const addBtn = (label, href) => group.appendChild(makeBtn(label, href, 'btn'));

    // Registration button (HPV + MÃ©ningite ACWY uniquement)
    const regUrl = introData?.registration?.url || introData?.registration?.online?.url;
    const regLabel = t(introData?.registration?.label || introData?.registration?.online?.label, 'Inscription en ligne (HPV + MÃ©ningite ACWY uniquement)');
    if(regUrl) {
  group.appendChild(
    makeBtn(regLabel, regUrl, 'btn', 'registration_hpv')
  );
}

    // Forms
    (introData?.resources?.forms || []).forEach(f => {
  group.appendChild(
    makeBtn(
      t(f.label, 'Formulaire'),
      f.url,
      'btn',
      f.type === 'hpv' ? 'form_hpv' : 'form_other'
    )
  );
});

    // Existing videos
(introData?.resources?.videos || []).forEach(v => {
  group.appendChild(
    makeBtn(
      t(v.title) || t(v.label),
      v.url,
      'btn',
      'video_info'
    )
  );
});

    // Existing email
    if(introData?.contact?.email){
  group.appendChild(
    makeBtn(
      introData.contact.email,
      `mailto:${introData.contact.email}`,
      'btn',
      'contact_email'
    )
  );
}


    // Additions (chef) â€” optional
// Ressources officielles HPV â€“ adolescents (toutes langues)
if (introData?.hpv_flyer_multilang?.url) {
  group.appendChild(
    makeBtn(
      t(introData.hpv_flyer_multilang.label, 'Ressources officielles HPV'),
      introData.hpv_flyer_multilang.url,
      'btn',
      'hpv_resources'
    )
  );
}
    if(introData?.official_idf?.flyer_pdf?.file){
  group.appendChild(
    makeBtn(
      t(introData.official_idf.flyer_pdf.label, 'Flyer officiel (PDF)'),
      normPath(introData.official_idf.flyer_pdf.file),
      'btn',
      'flyer_officiel'
    )
  );
}


    // Meningite documents
    if(introData?.meningite_documents){
      const mt = document.createElement('div');
      mt.style.marginTop = '14px';
      mt.style.fontWeight = '900';
      mt.textContent = t(introData.meningite_documents.label, 'MÃ©ningite â€“ documents');
      root.appendChild(mt);

      const mgroup = document.createElement('div');
      mgroup.className = 'resourceGroup';
      mgroup.style.marginTop = '10px';
      root.appendChild(mgroup);

      (introData.meningite_documents.items || []).forEach(it => {
  mgroup.appendChild(
    makeBtn(
      t(it.label, 'Document'),
      normPath(it.file),
      'btn',
      'meningite_doc'
    )
  );
});

// Calendrier simplifiÃ© des vaccinations â€“ 2025
if (introData?.calendar_simple?.file) {
  group.appendChild(
    makeBtn(
      t(introData.calendar_simple.label, 'Calendrier simplifiÃ© des vaccinations â€“ 2025'),
      normPath(introData.calendar_simple.file),
      'btn',
      'calendar_simple'
    )
  );
}
// Calendrier vaccinal complet â€“ 2025
if (introData?.calendar_full?.file) {
  group.appendChild(
    makeBtn(
      t(
        introData.calendar_full.label,
        'Les vaccins Ã  tous les Ã¢ges â€“ Calendrier vaccinal 2025'
      ),
      normPath(introData.calendar_full.file),
      'btn',
      'calendar_full'
    )
  );
}


      const note = t(introData.meningite_documents.note, '');
      if(note){
        const n = document.createElement('div');
        n.className = 'note';
        n.textContent = note;
        root.appendChild(n);
      }
    }
  }
const imgByStep = {
  1: 'img/step1.png',
  2: 'img/step2.png',
  3: 'img/step3.png'
};
function renderSteps(){
  const steps = introData?.intro?.vaccination_steps;
  if(!steps) return;

  const titleEl = document.getElementById('stepsTitle');
  const subtitleEl = document.getElementById('stepsSubtitle');
  const container = document.getElementById('stepsContainer');

  if(!titleEl || !subtitleEl || !container) return;

  titleEl.textContent = t(steps.title, '');
  subtitleEl.textContent = t(steps.subtitle, '');
  container.innerHTML = '';

  (steps.steps || []).forEach(step => {
  const div = document.createElement('div');
  div.className = 'stepItem';
  div.style.cursor = 'pointer';

div.innerHTML = `
  <img
    src="${imgByStep[step.number] || ''}"
    class="stepIllustration"
    aria-hidden="true"
  />
  <div class="stepNumber">${step.number}</div>
  <div>
    <div class="stepTitle">${t(step.title, '')}</div>
    <div class="stepText">${t(step.text, '')}</div>
  </div>
`;

  const actions = document.createElement('div');
actions.className = 'stepActions';
actions.dataset.step = step.number;
div.appendChild(actions);

div.addEventListener('click', (e) => {
  // â›” ne jamais intercepter les clics sur les liens
  if (e.target.closest('a')) return;

  const zone = actions;

  // Toggle simple
  if (zone.classList.contains('active')) {
    zone.classList.remove('active');
    zone.innerHTML = '';
    div.setAttribute('aria-expanded', 'false');
    return;
  }

  // Fermer les autres Ã©tapes ouvertes
  document.querySelectorAll('.stepActions.active').forEach(z => {
    z.classList.remove('active');
    z.innerHTML = '';
    z.parentElement?.setAttribute('aria-expanded', 'false');
  });

  zone.classList.add('active');
  div.setAttribute('aria-expanded', 'true');

  const group = document.createElement('div');
  group.className = 'resourceGroup';

  const allBtns = document.querySelectorAll('#introBody .btn');

  allBtns.forEach(btn => {
    const key = btn.dataset.key;
    const clone = btn.cloneNode(true);

    // Ã‰TAPE 1 â€” Sâ€™informer
    if (step.number === 1 && ['video_info','flyer_officiel','hpv_resources'].includes(key)) {
      group.appendChild(clone);
    }

    // Ã‰TAPE 2 â€” Consentement
    if (step.number === 2 && ['registration_hpv','form_hpv','form_other'].includes(key)) {
      group.appendChild(clone);
    }

    // Ã‰TAPE 3 â€” Vaccination
    if (step.number === 3 && ['contact_email','meningite_doc','calendar_simple','calendar_full'].includes(key)) {
      group.appendChild(clone);
    }
  });

  zone.appendChild(group);
});

  container.appendChild(div);
});

}

  function renderFAQ(){
    const q = (els.searchInput.value || '').trim().toLowerCase();
    const items = (faqData?.items || []).filter(it => {
      if(activeSection !== 'all' && it.section !== activeSection) return false;
      const question = safeText(t(it.q));
      const answer = safeText(t(it.a));
      const hay = (question + ' ' + answer).toLowerCase();
      if(!q) return true;
      return hay.includes(q);
    });

    els.faqTitle.textContent = t(faqData?.meta?.title, 'FAQ');
    const total = (faqData?.items || []).filter(it => activeSection==='all' ? true : it.section===activeSection).length;
    els.faqCount.textContent = `${items.length} / ${total}`;

    els.faqList.innerHTML = '';
    items.forEach(it => {
      const d = document.createElement('details');
      const s = document.createElement('summary');
      s.textContent = t(it.q, 'Question');
      const right = document.createElement('span');
      right.className = 'chip';
      const sec = (faqData?.sections || []).find(x => (x.key || x.id) === it.section);
      right.textContent = sec ? t(sec.title, it.section) : it.section;
      s.appendChild(right);

      const a = document.createElement('div');
      a.className = 'ans';
      a.textContent = t(it.a, '');

      d.appendChild(s);
      d.appendChild(a);

      els.faqList.appendChild(d);
    });
  }

  function applyDirection() {
    const rtlLangs = ['ar','ps','ku'];
    if (rtlLangs.includes(lang)) {
      document.body.classList.add('rtl');
      document.documentElement.setAttribute('dir','rtl');
    } else {
      document.body.classList.remove('rtl');
      document.documentElement.setAttribute('dir','ltr');
    }
  }

  async function init(){
    const [faqRes, introRes] = await Promise.all([
      fetch(FAQ_URL, {cache:'no-store'}),
      fetch(INTRO_URL, {cache:'no-store'})
    ]);
    faqData = await faqRes.json();
    introData = await introRes.json();

    // initial lang = first meta language if present
    const langs = faqData?.meta?.languages || ['fr'];
    lang = langs.includes('fr') ? 'fr' : langs[0];

    applyStaticTexts();
    buildLangButtons();
    buildSidebar();
    renderHero();
    renderIntro();
    renderSteps();
    requestAnimationFrame(() => {
  setTimeout(startStepPulse, 800);
});
    renderFAQ();
  }

  // Events
  els.burgerBtn.addEventListener('click', () => els.sidebar.classList.toggle('open'));
  els.searchInput.addEventListener('input', () => renderFAQ());
  document.addEventListener('click', (e) => {
    if(window.innerWidth <= 980){
      const inside = els.sidebar.contains(e.target) || els.burgerBtn.contains(e.target);
      if(!inside) els.sidebar.classList.remove('open');
    }
  });

  init().catch(err => {
    console.error(err);
    alert("Erreur de chargement des fichiers JSON. VÃ©rifiez que faq.json et intro_resources.json sont bien Ã  la racine du site.");
  });
// ===== FIX TÃ‰LÃ‰CHARGEMENT PDF (nom personnalisÃ© au clic) =====
document.addEventListener('click', (e) => {
  const link = e.target.closest('a');
  if (!link) return;

  const name = link.dataset.downloadName;
  if (name) {
    link.setAttribute('download', name);
  }
});
/* ===== THEME TOGGLE ===== */
const toggle = document.getElementById('themeToggle');
const root = document.documentElement;

const savedTheme = localStorage.getItem('theme') || 'light';
root.setAttribute('data-theme', savedTheme);
toggle.textContent = savedTheme === 'dark' ? 'â˜€ï¸' : 'ğŸŒ™';

toggle.addEventListener('click', () => {
  const current = root.getAttribute('data-theme');
  const next = current === 'dark' ? 'light' : 'dark';
  root.setAttribute('data-theme', next);
  localStorage.setItem('theme', next);
  toggle.textContent = next === 'dark' ? 'â˜€ï¸' : 'ğŸŒ™';
});

/* ===== PULSE GUIDÃ‰ DES Ã‰TAPES (RYTHME HUMAIN) ===== */
let pulseTimer = null;

function startStepPulse() {
  // sÃ©curitÃ© : mobile seulement
 // TEST UNIQUEMENT â€“ autoriser desktop
// if (!window.matchMedia('(max-width: 1024px)').matches) return;

  // nettoyage strict
  if (pulseTimer) {
    clearTimeout(pulseTimer);
    pulseTimer = null;
  }

  const steps = Array.from(document.querySelectorAll('.stepItem'));
  if (steps.length === 0) return;

  let index = 0;

  function pulseNext() {
    steps.forEach(s => s.classList.remove('pulse'));

    const step = steps[index];
    if (step) {
      step.classList.add('pulse');
      setTimeout(() => step.classList.remove('pulse'), 1200);
    }

    index++;

    if (index >= steps.length) {
      index = 0;
      pulseTimer = setTimeout(pulseNext, 6000); // pause longue
    } else {
      pulseTimer = setTimeout(pulseNext, 1500); // rythme humain
    }
  }

  pulseNext();
}
</script>
<script>
/* ===== RECHERCHE PLANNING VACCINATION COLLÃˆGES (SAFE) ===== */
let calendarConfig = null;

const SCHEDULE_URL = './schedule_sessions.json';
let scheduleData = null;

/* Utilitaires */
const normSchedule = s =>
  (s || '').toLowerCase().normalize('NFD').replace(/[\u0300-\u036f]/g, '');

const tSchedule = obj => obj?.[lang] || obj?.fr || '';

const SCHEDULE_TEXT = {
  hint: {
    fr: "Trouvez rapidement la date de vaccination de votre collÃ¨ge.\nIndiquez le nom de votre commune, votre code postal ou le nom du collÃ¨ge.",
    en: "Find your schoolâ€™s vaccination date.\nEnter your city, postal code or school name.",
    ar: "Ø§Ø¹Ø«Ø± Ø¨Ø³Ø±Ø¹Ø© Ø¹Ù„Ù‰ Ù…ÙˆØ¹Ø¯ Ø§Ù„ØªÙ„Ù‚ÙŠØ­ ÙÙŠ Ù…Ø¯Ø±Ø³Ø© Ø·ÙÙ„Ùƒ.\nØ£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø¯ÙŠÙ†Ø© Ø£Ùˆ Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ø¨Ø±ÙŠØ¯ÙŠ Ø£Ùˆ Ø§Ø³Ù… Ø§Ù„Ù…Ø¯Ø±Ø³Ø© Ù„Ù…Ø¹Ø±ÙØ© Ù…ÙˆØ¹Ø¯ Ø²ÙŠØ§Ø±Ø© ÙØ±ÙŠÙ‚ Ø§Ù„ØªÙ„Ù‚ÙŠØ­.",
    tr: "Okulunuzun aÅŸÄ± tarihini bulun.\nÅehir adÄ±, posta kodu veya okul adÄ±nÄ± girerek aÅŸÄ±lama tarihini Ã¶ÄŸrenin.",
    ps: "Ø¯ Ø®Ù¾Ù„ ÚšÙˆÙˆÙ†ÚÙŠ Ø¯ ÙˆØ§Ú©Ø³ÛŒÙ† Ù†ÛÙ¼Ù‡ ÙˆÙ…ÙˆÙ…Ø¦.\nØ¯ ÚšØ§Ø± Ù†ÙˆÙ…ØŒ Ù¾ÙˆØ³Ù¼ Ú©ÙˆÚ‰ ÛŒØ§ Ø¯ ÚšÙˆÙˆÙ†ÚÙŠ Ù†ÙˆÙ… ÙˆÙ„ÛŒÚ©Ø¦.",
    ku: "Ú•ÛÚ©Û•ÙˆØªÛŒ Ú¤Ø§Ú©Ø³ÛŒÙ†ÛŒ Ù‚ÙˆØªØ§Ø¨Ø®Ø§Ù†Û•Ú©Û•Øª Ø¨Ø¯Û†Ø²Û•ÙˆÛ•.\nÙ†Ø§ÙˆÛŒ Ø´Ø§Ø±ØŒ Ú©Û†Ø¯ÛŒ Ù¾Û†Ø³ØªÛ•ÛŒÛŒ ÛŒØ§Ù† Ù†Ø§ÙˆÛŒ Ù‚ÙˆØªØ§Ø¨Ø®Ø§Ù†Û• Ø¨Ù†ÙˆÙˆØ³Û•.",
    ro: "GÄƒsiÈ›i data vaccinÄƒrii È™colii.\nIntroduceÈ›i localitatea, codul poÈ™tal sau numele È™colii.",
    ka: "áƒ˜áƒáƒáƒ•áƒ”áƒ— áƒ—áƒ¥áƒ•áƒ”áƒœáƒ˜ áƒ¡áƒ™áƒáƒšáƒ˜áƒ¡ áƒ•áƒáƒ¥áƒªáƒ˜áƒœáƒáƒªáƒ˜áƒ˜áƒ¡ áƒ—áƒáƒ áƒ˜áƒ¦áƒ˜.\náƒ¨áƒ”áƒ˜áƒ§áƒ•áƒáƒœáƒ”áƒ— áƒ¥áƒáƒšáƒáƒ¥áƒ˜, áƒ¡áƒáƒ¤áƒáƒ¡áƒ¢áƒ áƒ™áƒáƒ“áƒ˜ áƒáƒœ áƒ¡áƒ™áƒáƒšáƒ˜áƒ¡ áƒ¡áƒáƒ®áƒ”áƒšáƒ˜."
  },
  placeholder: {
    fr: "Ville, code postal ou nom du collÃ¨geâ€¦",
    en: "City, postal code or school nameâ€¦",
    ar: "Ø§Ù„Ù…Ø¯ÙŠÙ†Ø© Ø£Ùˆ Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ø¨Ø±ÙŠØ¯ÙŠ Ø£Ùˆ Ø§Ø³Ù… Ø§Ù„Ù…Ø¯Ø±Ø³Ø©â€¦",
    tr: "Åehir, posta kodu veya okul adÄ±â€¦",
    ps: "ÚšØ§Ø±ØŒ Ù¾ÙˆØ³Ù¼ Ú©ÙˆÚ‰ ÛŒØ§ Ø¯ ÚšÙˆÙˆÙ†ÚÙŠ Ù†ÙˆÙ…â€¦",
    ku: "Ø´Ø§Ø±ØŒ Ú©Û†Ø¯ÛŒ Ù¾Û†Ø³ØªÛ•ÛŒÛŒ ÛŒØ§Ù† Ù†Ø§ÙˆÛŒ Ù‚ÙˆØªØ§Ø¨Ø®Ø§Ù†Û•â€¦",
    ro: "Localitate, cod poÈ™tal sau numele È™coliiâ€¦",
    ka: "áƒ¥áƒáƒšáƒáƒ¥áƒ˜, áƒ¡áƒáƒ¤áƒáƒ¡áƒ¢áƒ áƒ™áƒáƒ“áƒ˜ áƒáƒœ áƒ¡áƒ™áƒáƒšáƒ˜áƒ¡ áƒ¡áƒáƒ®áƒ”áƒšáƒ˜â€¦"
  },
  addCalendar: {
    fr: "Ajouter au calendrier",
    en: "Add to calendar",
    ar: "Ø¥Ø¶Ø§ÙØ© Ø¥Ù„Ù‰ Ø§Ù„ØªÙ‚ÙˆÙŠÙ…",
    tr: "Takvime ekle",
    ps: "Ú©Ø§Ù„ÛÙ†Ú‰Ø± ØªÙ‡ Ø§Ø¶Ø§ÙÙ‡ Ú©Ú“Ø¦",
    ku: "Ø²ÛŒØ§Ø¯Ú©Ø±Ø¯Ù† Ø¨Û† Ú•Û†Ú˜Ú˜Ù…ÛØ±",
    ro: "AdaugÄƒ Ã®n calendar",
    ka: "áƒ™áƒáƒšáƒ”áƒœáƒ“áƒáƒ áƒ¨áƒ˜ áƒ“áƒáƒ›áƒáƒ¢áƒ”áƒ‘áƒ"
  }
};

async function initScheduleSearch() {
  const hint = document.getElementById('scheduleHint');
  const input = document.getElementById('scheduleSearchInput');
  const results = document.getElementById('scheduleResults');

  if (!hint || !input || !results) return;

  const res = await fetch(SCHEDULE_URL, { cache: 'no-store' });
  scheduleData = await res.json();
calendarConfig = scheduleData.calendar_message;

  applyScheduleTexts();

  input.addEventListener('input', () => {
  const q = normSchedule(input.value);
  results.innerHTML = '';
  results.style.display = 'none';
  if (q.length < 2) return;

  const matches = scheduleData.sessions.filter(s =>
    normSchedule(s.city).includes(q) ||
    normSchedule(s.postal_code).includes(q) ||
    normSchedule(s.college_name).includes(q)
  );

  if (matches.length === 0) {
    results.style.display = 'block';
    results.innerHTML = `
      <div class="card" style="padding:12px;color:var(--muted);">
        ${lang === 'fr' ? 'Aucun rÃ©sultat trouvÃ©.' :
          lang === 'en' ? 'No result found.' :
          lang === 'ar' ? 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬.' :
          lang === 'tr' ? 'SonuÃ§ bulunamadÄ±.' :
          lang === 'ps' ? 'Ù‡ÛŒÚ… Ù¾Ø§ÛŒÙ„Ù‡ ÙˆÙ†Ù‡ Ù…ÙˆÙ†Ø¯Ù„ Ø´ÙˆÙ‡.' :
          lang === 'ku' ? 'Ù‡ÛŒÚ† Ø¦Û•Ù†Ø¬Ø§Ù…ÛÚ© Ù†Û•Ø¯Û†Ø²Ø±Ø§ÛŒÛ•ÙˆÛ•.' :
          lang === 'ro' ? 'Niciun rezultat gÄƒsit.' :
          'áƒ¨áƒ”áƒ“áƒ”áƒ’áƒ˜ áƒ•áƒ”áƒ  áƒ›áƒáƒ˜áƒ«áƒ”áƒ‘áƒœáƒ'}
      </div>`;
    return;
  }

  results.style.display = 'block';
results.scrollIntoView({ behavior: 'smooth', block: 'nearest' });

  matches.forEach(s => {
    const div = document.createElement('div');
    div.className = 'card';
    div.style.padding = '14px';
    div.style.marginBottom = '8px';
    div.style.cursor = 'pointer';

    const dateStr = new Date(s.date).toLocaleDateString(
      lang === 'en' ? 'en-GB' : 'fr-FR',
      { weekday:'long', day:'numeric', month:'long', year:'numeric' }
    );

    div.innerHTML = `
      <strong>${s.college_name}</strong><br>
      <span style="color:var(--muted)">${s.city} (${s.postal_code})</span><br>
      <span>ğŸ“… ${dateStr}</span><br>
      <button class="btn primary" style="margin-top:8px">
        ${tSchedule(SCHEDULE_TEXT.addCalendar)}
      </button>
    `;

    div.querySelector('button').addEventListener('click', (e) => {
      e.stopPropagation();
      downloadICS(s);
    });

    results.appendChild(div);
  });
});

}

function applyScheduleTexts() {
  const hint = document.getElementById('scheduleHint');
  const input = document.getElementById('scheduleSearchInput');
  if (hint) hint.textContent = tSchedule(SCHEDULE_TEXT.hint);
  if (input) input.placeholder = tSchedule(SCHEDULE_TEXT.placeholder);
}

/* Hook langue EXISTANT */
const _setLang = window.setLanguage;
window.setLanguage = function (l) {
  _setLang(l);
  applyScheduleTexts();
};
function downloadICS(session) {
  if (!calendarConfig) return;

  const title =
    calendarConfig.title?.[lang] ||
    calendarConfig.title?.fr;

  const message =
    calendarConfig.description?.[lang] ||
    calendarConfig.description?.fr;

  const date = session.date.replace(/-/g, '');
  const endDate = new Date(session.date);
  endDate.setDate(endDate.getDate() + 1);
  const end = endDate.toISOString().slice(0,10).replace(/-/g,'');

  const esc = s =>
    s.replace(/\\/g,'\\\\')
     .replace(/\n/g,'\\n')
     .replace(/,/g,'\\,')
     .replace(/;/g,'\\;');

  const ics = `
BEGIN:VCALENDAR
VERSION:2.0
PRODID:-//Vaccination CollÃ¨ge IDF//FR
CALSCALE:GREGORIAN
BEGIN:VEVENT
UID:${Date.now()}@vaccination-idf.fr
SUMMARY:${esc(title)}
DTSTART;VALUE=DATE:${date}
DTEND;VALUE=DATE:${end}
LOCATION:${esc(`${session.college_name} â€“ ${session.city} (${session.postal_code})`)}
DESCRIPTION:${esc(message)}
BEGIN:VALARM
TRIGGER:${calendarConfig.reminder?.offset || '-P1D'}
ACTION:DISPLAY
DESCRIPTION:${esc(title)}
END:VALARM
END:VEVENT
END:VCALENDAR`.trim();

  const blob = new Blob([ics], { type: 'text/calendar;charset=utf-8' });
  const url = URL.createObjectURL(blob);

  const a = document.createElement('a');
  a.href = url;
  a.download = `vaccination-${session.college_name}.ics`;
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
  URL.revokeObjectURL(url);
}

document.addEventListener('DOMContentLoaded', initScheduleSearch);
</script>

    </body>
</html>
