<!DOCTYPE html>

<html lang="fr">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<title>Vaccination coll√®ge ‚Äì √éle-de-France</title>
<style>
:root {
  --bg:#f5f7fb;
  --card:#ffffff;
  --text:#111827;
  --muted:#6b7280;
  --border:#e5e7eb;
  --primary:#2563eb;
  --primary-soft:#e0e7ff;
  --accent:#16a34a;
  --accent-soft:#dcfce7;
  --btn:#ffffff;
}
[data-theme="dark"] {
  --bg:#0f172a;
  --card:#111827;
  --text:#e5e7eb;
  --muted:#9ca3af;
  --border:#1f2937;
  --primary:#38bdf8;
  --primary-soft:#0c4a6e;
  --accent:#22c55e;
  --accent-soft:#052e1b;
  --btn:#020617;
}

body { background: var(--bg); color: var(--text); }

.card,
details,
.search,
.select {
  background: var(--card);
  color: var(--text);
  border-color: var(--border);
}

summary { color: var(--text); }

.ans { color:#d1d5db; }

.chip,
.tag {
  background:#020617;
  border-color:var(--border);
  color:#cbd5f5;
}

.langBtn {
  background:#020617;
  color:var(--text);
  border-color:var(--border);
}

.langBtn.active {
  background: var(--primary-soft);
  color:#e0f2fe;
}

.navItem:hover {
  background:#020617;
  border-color: rgba(56,189,248,.25);
}

.navItem.active {
  background: var(--primary-soft);
  border-color: rgba(56,189,248,.35);
}

.btn.primary {
  background: var(--primary);
  border-color: rgba(56,189,248,.45);
}

.btn.soft {
  background: var(--accent-soft);
  border-color: rgba(34,197,94,.35);
  color:#bbf7d0;
}

    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: var(--font);
      color:var(--text);
      background:var(--bg);
    }
    a{color:inherit}
    .layout{display:flex; min-height:100vh;}
    /* Sidebar */
    .sidebar{
      width: var(--sidebar);
      padding: 18px 14px;
      position: sticky;
      top:0;
      height:100vh;
      overflow:auto;
      border-right:1px solid var(--border);
      background:linear-gradient(180deg, #ffffff 0%, #fbfcff 100%);
    }
    .brand{
      display:flex; align-items:center; gap:10px;
      padding:10px 10px 14px 10px;
    }
    .brandMark{
      width:36px;height:36px;border-radius:12px;
      background: var(--primary-soft);
      display:grid;place-items:center;
      color:var(--primary); font-weight:800;
      border:1px solid rgba(47,91,255,.18);
    }
    .brandName{font-weight:800; letter-spacing:.2px}
    .navTitle{
      margin: 8px 10px 8px;
      font-size: 12px;
      letter-spacing:.08em;
      text-transform: uppercase;
      color:var(--muted);
    }
    .navList{display:flex; flex-direction:column; gap:6px; padding:0 6px 16px}
    .navItem{
      border:1px solid transparent;
      padding:10px 10px;
      border-radius: 12px;
      cursor:pointer;
      color: #1f2937;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
    }
    .navItem:hover{background:#f4f7ff; border-color: rgba(47,91,255,.14);}
    .navItem.active{background:var(--primary-soft); border-color: rgba(47,91,255,.22);}
    .chip{
      font-size:12px; padding:2px 8px; border-radius:999px;
      background:#f3f4f6; color:#374151;
      border:1px solid var(--border);
      white-space:nowrap;
    }
    .footNote{
      padding: 12px 10px;
      color:var(--muted);
      font-size:12px;
      border-top:1px solid var(--border);
      margin-top:10px;
    }
    /* Main */
    .main{flex:1; padding:18px;}
    .topbar{
      max-width: var(--max);
      margin: 0 auto 14px;
      display:flex; align-items:center; justify-content:space-between;
      gap:12px;
    }
    .rightBar{display:flex; align-items:center; gap:10px; flex-wrap:wrap; justify-content:flex-end;}
    .select{
      padding:10px 12px;
      border:1px solid var(--border);
      border-radius: 12px;
      background:#fff;
      font-weight:600;
    }
    .search{
      display:flex; align-items:center; gap:10px;
      padding:10px 12px;
      border:1px solid var(--border);
      border-radius: 12px;
      background:#fff;
      min-width: 260px;
    }
    .search input{
      border:none; outline:none; width:100%;
      font-size:14px;
    }
    .container{max-width: var(--max); margin:0 auto;}
    .hero{
      display:grid;
      grid-template-columns: 1.4fr 1fr;
      gap:16px;
      align-items:stretch;
      margin-bottom: 16px;
    }
    .card{
      background:var(--card);
      border:1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
    }
    .heroText{padding:22px;}
    .kicker{
      display:inline-flex; align-items:center; gap:8px;
      padding:8px 12px;
      border-radius: 999px;
      background: var(--primary-soft);
      color: var(--primary);
      font-weight:800;
      border:1px solid rgba(47,91,255,.18);
      font-size:12px;
      letter-spacing:.02em;
    }
    h1{
      margin:12px 0 10px;
      font-size:46px;
      line-height:1.08;
      letter-spacing:-.02em;
    }
    h1 .accent{color: var(--accent)}
    .subtitle{
      margin:0;
      color: var(--muted);
      font-size:16px;
      line-height:1.55;
      max-width: 62ch;
    }
    .btnRow{display:flex; gap:10px; flex-wrap:wrap; margin-top:16px}
    .btn{
      display:inline-flex; align-items:center; justify-content:center;
      padding:10px 14px;
      border-radius: 999px;
      border:1px solid var(--border);
      background:#fff;
      text-decoration:none;
      font-weight:800;
      font-size:13px;
      cursor:pointer;
      transition: transform .05s ease;
    }
    .btn:hover{transform: translateY(-1px)}
    .btn.primary{
      background: var(--primary);
      border-color: rgba(47,91,255,.45);
      color:#fff;
    }
    .btn.soft{
      background: var(--accent-soft);
      border-color: rgba(255,138,0,.22);
      color:#7a3a00;
    }
    .heroArt{
      padding:18px;
      position:relative;
      overflow:hidden;
    }
    .artBox{
      height: 100%;
      border-radius: 16px;
      background: radial-gradient(circle at 20% 20%, rgba(47,91,255,.15), transparent 45%),
                  radial-gradient(circle at 70% 30%, rgba(255,138,0,.18), transparent 55%),
                  linear-gradient(180deg, #ffffff 0%, #f6f8ff 100%);
      border:1px solid rgba(17,24,39,.06);
      display:flex;
      align-items:center;
      justify-content:center;
      position:relative;
      min-height: 240px;
    }
    .artLabel{
      position:absolute;
      bottom:14px;
      left:14px;
      right:14px;
      padding:10px 12px;
      border-radius: 14px;
      background: rgba(255,255,255,.85);
      border:1px solid rgba(17,24,39,.08);
      color:var(--muted);
      font-size:12px;
    }
    .logoImg{
      height:38px; max-width: 220px; object-fit:contain;
      filter: drop-shadow(0 2px 6px rgba(0,0,0,.12));
      margin-bottom: 10px;
    }
    /* Sections */
    .grid{
      display:grid;
      grid-template-columns: 1fr;
      gap:16px;
    }
    .sectionHead{
      padding:18px 20px 0;
    }
    .sectionTitle{
      margin:0;
      font-size:16px;
      font-weight:900;
      letter-spacing:.2px;
    }
    .sectionDesc{
      margin:6px 0 0;
      color:var(--muted);
      font-size:13px;
      line-height:1.5;
    }
    .sectionBody{padding:14px 20px 20px;}
    .resourceGroup{display:flex; flex-wrap:wrap; gap:10px}
    .note{
      margin-top:10px;
      color:var(--muted);
      font-size:12px;
      line-height:1.55;
      white-space:pre-wrap;
    }
    /* FAQ */
    .faqMeta{display:flex; align-items:flex-start; justify-content:space-between; gap:10px; flex-wrap:wrap}
    .faqTitle{
      margin:0;
      font-size:18px;
      font-weight:900;
    }
    .faqCount{color:var(--muted); font-size:12px; margin-top:6px}
    .accordion{display:flex; flex-direction:column; gap:10px; margin-top:12px}
    details{
      background:#fff;
      border:1px solid var(--border);
      border-radius: 14px;
      padding: 12px 14px;
    }
    summary{
      cursor:pointer;
      list-style:none;
      font-weight:850;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
    }
    summary::-webkit-details-marker{display:none}
    .ans{color:#374151; font-size:14px; line-height:1.6; margin-top:10px; white-space:pre-wrap;}
    .tagRow{display:flex; gap:8px; flex-wrap:wrap; margin-top:8px}
    .tag{font-size:12px; padding:2px 8px; border-radius:999px; background:#f3f4f6; border:1px solid var(--border); color:#374151}
    /* Mobile */
    .burger{
      display:none;
      padding:10px 12px;
      border:1px solid var(--border);
      border-radius: 12px;
      background:#fff;
      font-weight:800;
      cursor:pointer;
    }
    @media (max-width: 980px){
      .hero{grid-template-columns: 1fr;}
      h1{font-size:38px}
      .sidebar{position:fixed; left:-320px; top:0; bottom:0; z-index:50; transition:left .2s ease;}
      .sidebar.open{left:0}
      .burger{display:inline-flex}
      .search{min-width: 200px}
    }
  
    /* ===== UI adjustments (no sidebar, no search) ===== */
    .sidebar{display:none !important;}
    .burger{display:none !important;}
    .search{display:none !important;}
    .layout{grid-template-columns: 1fr !important;}
    .main{padding-left: 0 !important;}
    .select{padding:12px 16px !important; border-radius:14px !important; font-size:15px !important; min-width:180px;}
    /* ===== RTL languages support (Arabic, Pashto, Kurdish) ===== */
    .rtl { direction: rtl; text-align: right; }
    .rtl .hero, .rtl .card, .rtl .sectionBody, .rtl .sectionTitle, .rtl .sectionDesc,
    .rtl p, .rtl li, .rtl .faqQ, .rtl .faqA { text-align: right; }



/* Language buttons */
.langButtons{display:flex; gap:8px; flex-wrap:wrap; justify-content:flex-end; align-items:center}
.langBtn{border:1px solid rgba(0,0,0,.12); background:#fff; color:var(--text); padding:8px 10px; border-radius:999px; cursor:pointer;
  font-size:13px; font-weight:700; line-height:1; display:flex; gap:6px; align-items:center}
.langBtn:hover{box-shadow:0 2px 10px rgba(0,0,0,.08)}
.langBtn.active{background:var(--primary-light); border-color:rgba(0,95,115,.35)}
/* ===============================
   THEME FIX ‚Äì A COLLER ICI
   =============================== */

body {
  background: var(--bg);
  color: var(--text);
}

.card,
details,
.search,
.select {
  background: var(--card) !important;
  color: var(--text) !important;
  border: 1px solid var(--border) !important;
}

summary {
  color: var(--text) !important;
}

.ans {
  color: var(--text) !important;
}

.btn {
  background: var(--btn) !important;
  color: var(--text) !important;
  border-color: var(--border) !important;
}

.btn.primary {
  background: var(--primary) !important;
  color: #ffffff !important;
}

.btn.soft {
  background: var(--accent-soft) !important;
  color: var(--accent) !important;
}

.chip,
.tag {
  background: var(--primary-soft) !important;
  color: var(--text) !important;
  border-color: var(--border) !important;
}

details[open] {
  border-color: var(--primary) !important;
}

.artBox {
  background: linear-gradient(
    180deg,
    var(--card) 0%,
    var(--bg) 100%
  ) !important;
}
/* ===== FIX LANG BUTTONS ‚Äì DARK MODE ===== */
[data-theme="dark"] .langBtn {
  background: var(--card) !important;
  color: var(--text) !important;
  border-color: var(--border) !important;
}

[data-theme="dark"] .langBtn.active {
  background: var(--primary) !important;
  color: #ffffff !important;
}
/* ===== CONTACT SECTION WIDE ===== */
.contactWide {
  padding-top: 20px;
}

.contactGrid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
  gap: 14px;
}

.contactItem {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 14px 16px;
  border-radius: 16px;
  background: var(--card);
  border: 1px solid var(--border);
  color: var(--text);
  text-decoration: none;
  font-weight: 700;
  transition: background .15s ease, transform .05s ease;
}

.contactItem:hover {
  background: var(--primary-soft);
  transform: translateY(-1px);
}

.contactIcon {
  font-size: 20px;
}

.contactText {
  line-height: 1.35;
}
</style>
</head>
<body>
<div class="layout">
<aside class="sidebar" id="sidebar">
<div class="brand">
<div class="brandMark">V</div>
<div>
<div class="brandName">Vaccination Coll√®ge</div>
<div style="color:var(--muted);font-size:12px;margin-top:2px">HPV ‚Ä¢ M√©ningite ACWY ‚Ä¢ Rappels</div>
</div>
</div>
<div class="navTitle">Sections</div>
<div class="navList" id="navList"></div>
<div class="footNote" id="sideFooter">
        Astuce : utilisez la recherche pour trouver rapidement une r√©ponse.
      </div>
</aside>
<main class="main">
<div class="topbar container">
<button class="burger" id="burgerBtn">‚ò∞ Menu</button>
<div style="flex:1"></div>
<div class="rightBar">
<div class="search" title="Rechercher dans la FAQ">
            üîé <input id="searchInput" placeholder="Rechercher‚Ä¶" type="search"/>
</div>
<div aria-label="Langue" class="langButtons" id="langButtons"></div>
<button id="themeToggle" class="btn" title="Mode clair / sombre">üåô</button>
</div>
</div>
<div class="container">
<section class="hero">
<div class="card heroText">
<div class="kicker" id="heroKicker">Informations &amp; inscription</div>
<h1 id="heroTitle">Vaccination <span class="accent">coll√®ge</span><br/>√éle-de-France</h1>
<p class="subtitle" id="heroSubtitle">
              Acc√©dez aux informations essentielles, aux documents et √† la FAQ. L‚Äôinscription se fait en quelques clics.
            </p>
<div class="btnRow" id="heroBtns"></div>
</div>
<div class="card heroArt">
<div class="artBox">
<div style="height:100%;display:flex;align-items:center;justify-content:center;padding:18px;">
<img alt="Logo du service" src="img/logo_service.png" style="max-width:320px;max-height:180px;width:auto;height:auto;object-fit:contain;filter: drop-shadow(0 6px 18px rgba(17,24,39,.18));"/>
</div>
</div>
</div>
</section></div>
<div class="grid">
<section class="card" id="introCard">
<div class="sectionHead">
<div class="sectionTitle" id="introTitle">Message &amp; ressources</div>
<div class="sectionDesc" id="introDesc">Documents officiels, formulaires et vid√©os.</div>
</div>
<div class="sectionBody" id="introBody"></div>
</section>
<section class="card" id="faqCard">
<div class="sectionHead">
<div class="faqMeta">
<div>
<div class="faqTitle" id="faqTitle">FAQ</div>
<div class="faqCount" id="faqCount"></div>
</div>
<div class="tagRow" id="activeFilters"></div>
</div>
</div>
<div class="sectionBody">
<div class="accordion" id="faqList"></div>
</div>
</section>
<section class="card" id="contactCard" style="margin-top:16px;">
<div class="sectionHead">
<div class="sectionTitle" id="contactTitle">Nous contacter</div>
<div class="sectionDesc" id="contactDesc">Adresse, t√©l√©phone et email.</div>
</div>
<div class="sectionBody contactWide">

  <div class="contactGrid">

    <!-- Adresse -->
    <a
      class="contactItem"
      href="https://maps.app.goo.gl/zGLgVufgVPTTqRAg8"
      target="_blank"
      rel="noopener"
      title="Ouvrir dans Google Maps"
    >
      <span class="contactIcon">üìç</span>
      <span class="contactText">
        8 Rue de Vaux<br/>
        77000 Melun
      </span>
    </a>

    <!-- T√©l√©phone 1 -->
    <a class="contactItem" href="tel:0181742850">
      <span class="contactIcon">‚òéÔ∏è</span>
      <span class="contactText">01 81 74 28 50</span>
    </a>

    <!-- T√©l√©phone 2 -->
    <a class="contactItem" href="tel:0181743247">
      <span class="contactIcon">‚òéÔ∏è</span>
      <span class="contactText">01 81 74 32 47</span>
    </a>

    <!-- Email -->
    <a class="contactItem" href="mailto:vaccin-hpv@ghsif.fr">
      <span class="contactIcon">‚úâÔ∏è</span>
      <span class="contactText">vaccin-hpv@ghsif.fr</span>
    </a>

  </div>

</div>

</section>
</div>
</main></div>
<script>
  const FAQ_URL = './faq.json';
  const INTRO_URL = './intro_resources.json';

  const els = {
    sidebar: document.getElementById('sidebar'),
    burgerBtn: document.getElementById('burgerBtn'),
    navList: document.getElementById('navList'),
    langButtons: document.getElementById('langButtons'),
    searchInput: document.getElementById('searchInput'),
    heroBtns: document.getElementById('heroBtns'),
    introBody: document.getElementById('introBody'),
    faqTitle: document.getElementById('faqTitle'),
    faqCount: document.getElementById('faqCount'),
    faqList: document.getElementById('faqList'),
    activeFilters: document.getElementById('activeFilters'),
    heroKicker: document.getElementById('heroKicker'),
    heroTitle: document.getElementById('heroTitle'),
    heroSubtitle: document.getElementById('heroSubtitle'),
    introTitle: document.getElementById('introTitle'),
    introDesc: document.getElementById('introDesc'),
    contactTitle: document.getElementById('contactTitle'),
    contactDesc: document.getElementById('contactDesc'),
  };

  let faqData = null;
  let introData = null;
  let lang = 'fr';
  let activeSection = 'all';

  const safeText = (v) => (v ?? '').toString();

  const normPath = (p) => {
    if(!p) return p;
    // On GitHub Pages (project pages), absolute paths like /img/... break.
    // So we normalize to relative paths.
    return (typeof p === 'string' && p.startsWith('/')) ? p.slice(1) : p;
  };

  const t = (obj, fallback='') => {
    if(!obj) return fallback;
    return obj[lang] || obj.fr || obj.en || Object.values(obj)[0] || fallback;
  };

  // Static UI texts that are not stored in JSON
  const UI_TEXT = {
    heroKicker: {
      fr: "Informations & inscription",
      en: "Information & registration",
      ar: "ŸÖÿπŸÑŸàŸÖÿßÿ™ ŸàÿßŸÑÿ™ÿ≥ÿ¨ŸäŸÑ",
      tr: "Bilgi ve kayƒ±t",
      ps: "ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸà ÿ´ÿ®ÿ™ ŸÜÿßŸÖ",
      ku: "ÿ≤ÿßŸÜ€åÿßÿ±€å Ÿà ÿ™€ÜŸÖÿßÿ±⁄©ÿ±ÿØŸÜ",
      ro: "Informa»õii »ôi √Ænscriere",
      ka: "·Éò·Éú·É§·Éù·É†·Éõ·Éê·É™·Éò·Éê ·Éì·Éê ·É†·Éî·Éí·Éò·É°·É¢·É†·Éê·É™·Éò·Éê"
    },
    heroTitleHtml: {
      fr: "Vaccination <span class=\"accent\">coll√®ge</span><br/>√éle-de-France",
      en: "School <span class=\"accent\">vaccination</span><br/>√éle-de-France",
      ar: "ÿßŸÑÿ™ŸÑŸÇŸäÿ≠ <span class=\"accent\">ŸÅŸä ÿßŸÑÿ•ÿπÿØÿßÿØŸäÿ©</span><br/>√éle-de-France",
      tr: "Okul <span class=\"accent\">a≈üƒ±lamasƒ±</span><br/>√éle-de-France",
      ps: "ÿØ ⁄öŸàŸàŸÜ⁄ÅŸä <span class=\"accent\">Ÿàÿß⁄©ÿ≥€åŸÜ</span><br/>√éle-de-France",
      ku: "⁄§ÿß⁄©ÿ≥€åŸÜ€å <span class=\"accent\">ŸÇŸàÿ™ÿßÿ®ÿÆÿßŸÜ€ï</span><br/>√éle-de-France",
      ro: "Vaccinare <span class=\"accent\">la colegiu</span><br/>√éle-de-France",
      ka: "·É°·Éô·Éù·Éö·Éò·É° <span class=\"accent\">·Éï·Éê·É•·É™·Éò·Éú·Éê·É™·Éò·Éê</span><br/>√éle-de-France"
    },
    heroSubtitle: {
      fr: "Acc√©dez aux informations essentielles, aux documents et √† la FAQ. L‚Äôinscription se fait en quelques clics.",
      en: "Access key information, documents and the FAQ. Registration takes just a few clicks.",
      ar: "ÿßÿ∑ŸëŸÑÿπ ÿπŸÑŸâ ÿßŸÑŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸÑÿ£ÿ≥ÿßÿ≥Ÿäÿ© ŸàÿßŸÑŸàÿ´ÿßÿ¶ŸÇ ŸàÿßŸÑÿ£ÿ≥ÿ¶ŸÑÿ© ÿßŸÑÿ¥ÿßÿ¶ÿπÿ©. Ÿäÿ™ŸÖ ÿßŸÑÿ™ÿ≥ÿ¨ŸäŸÑ ÿ®ÿ®ÿ∂ÿπ ŸÜŸÇÿ±ÿßÿ™.",
      tr: "Temel bilgilere, belgelere ve SSS'ye eri≈üin. Kayƒ±t birka√ß tƒ±klamayla yapƒ±lƒ±r.",
      ps: "ŸÖŸáŸÖŸà ŸÖÿπŸÑŸàŸÖÿßÿ™Ÿàÿå ÿßÿ≥ŸÜÿßÿØŸà ÿßŸà ŸæŸà⁄öÿ™ŸÜŸà-⁄ÅŸàÿßÿ®ŸàŸÜŸà ÿ™Ÿá ŸÑÿßÿ≥ÿ±ÿ≥€å ŸàŸÖŸàŸÖÿ¶. ŸÜŸàŸÖ ŸÑ€å⁄©ŸÜŸá ŸæŸá ⁄ÖŸà ⁄©ŸÑ€å⁄©ŸàŸÜŸà ⁄©€ê ⁄©€ê⁄ñŸä.",
      ku: "ÿØ€ïÿ≥ÿ™⁄Ø€ï€åÿ¥ÿ™ŸÜ ÿ®€ï ÿ≤ÿßŸÜ€åÿßÿ±€å€å ⁄Øÿ±ŸÜ⁄Øÿå ÿ®€ï⁄µ⁄Ø€ïŸÜÿßŸÖ€ï⁄©ÿßŸÜ Ÿà FAQ. ÿ™€ÜŸÖÿßÿ±⁄©ÿ±ÿØŸÜ ÿ®€ï ⁄Ü€ïŸÜÿØ ⁄©ŸÑ€å⁄©€é⁄©€ï.",
      ro: "AcceseazƒÉ informa»õiile esen»õiale, documentele »ôi √ÆntrebƒÉrile frecvente. √énscrierea se face √Æn c√¢teva clicuri.",
      ka: "·Éõ·Éò·Éò·É¶·Éî·Éó ·É¨·Éï·Éì·Éù·Éõ·Éê ·Éê·É£·É™·Éò·Éö·Éî·Éë·Éî·Éö ·Éò·Éú·É§·Éù·É†·Éõ·Éê·É™·Éò·Éê·Éñ·Éî, ·Éì·Éù·Éô·É£·Éõ·Éî·Éú·É¢·Éî·Éë·Éñ·Éî ·Éì·Éê FAQ-·Éñ·Éî. ·É†·Éî·Éí·Éò·É°·É¢·É†·Éê·É™·Éò·Éê ·É†·Éê·Éõ·Éì·Éî·Éú·Éò·Éõ·Éî ·Éì·Éê·É¨·Éô·Éê·Éû·Éî·Éë·Éò·Éó ·ÉÆ·Éì·Éî·Éë·Éê."
    },
    introTitle: {
      fr: "Message & ressources",
      en: "Message & resources",
      ar: "ÿ±ÿ≥ÿßŸÑÿ© ŸàŸÖŸàÿßÿ±ÿØ",
      tr: "Mesaj ve kaynaklar",
      ps: "Ÿæ€åÿ∫ÿßŸÖ ÿßŸà ÿ≥ÿ±⁄Ü€åŸÜ€ê",
      ku: "Ÿæ€ï€åÿßŸÖ Ÿà ÿ≥€ïÿ±⁄ÜÿßŸà€ï⁄©ÿßŸÜ",
      ro: "Mesaj »ôi resurse",
      ka: "·É®·Éî·É¢·Éß·Éù·Éë·Éò·Éú·Éî·Éë·Éê ·Éì·Éê ·É†·Éî·É°·É£·É†·É°·Éî·Éë·Éò"
    },
    introDesc: {
      fr: "Documents officiels, formulaires et vid√©os.",
      en: "Official documents, forms and videos.",
      ar: "Ÿàÿ´ÿßÿ¶ŸÇ ÿ±ÿ≥ŸÖŸäÿ© ŸàŸÜŸÖÿßÿ∞ÿ¨ ŸàŸÅŸäÿØŸäŸàŸáÿßÿ™.",
      tr: "Resm√Æ belgeler, formlar ve videolar.",
      ps: "ÿ±ÿ≥ŸÖŸä ÿßÿ≥ŸÜÿßÿØÿå ŸÅŸàÿ±ŸÖŸàŸÜŸá ÿßŸà Ÿà€å⁄â€åŸà⁄´ÿßŸÜ€ê.",
      ku: "ÿ®€ï⁄µ⁄Ø€ïŸÜÿßŸÖ€ï ŸÅ€ïÿ±ŸÖ€å€å€ï⁄©ÿßŸÜÿå ŸÅ€Üÿ±ŸÖ€ï⁄©ÿßŸÜ Ÿà ⁄§€åÿØ€å€Ü⁄©ÿßŸÜ.",
      ro: "Documente oficiale, formulare »ôi videoclipuri.",
      ka: "·Éù·É§·Éò·É™·Éò·Éê·Éö·É£·É†·Éò ·Éì·Éù·Éô·É£·Éõ·Éî·Éú·É¢·Éî·Éë·Éò, ·É§·Éù·É†·Éõ·Éî·Éë·Éò ·Éì·Éê ·Éï·Éò·Éì·Éî·Éù·Éî·Éë·Éò."
    },
    contactTitle: {
      fr: "Nous contacter",
      en: "Contact us",
      ar: "ÿßÿ™ÿµŸÑ ÿ®ŸÜÿß",
      tr: "Bize ula≈üƒ±n",
      ps: "ŸÖŸà⁄ñ ÿ≥ÿ±Ÿá ÿß⁄ì€å⁄©Ÿá",
      ku: "Ÿæ€ï€åŸà€ïŸÜÿØ€å Ÿæ€éŸà€ï ÿ®⁄©€ï",
      ro: "Contact",
      ka: "·Éì·Éê·Éí·Éï·Éò·Éô·Éê·Éï·É®·Éò·É†·Éì·Éò·Éó"
    },
    contactDesc: {
      fr: "Adresse, t√©l√©phone et email.",
      en: "Address, phone and email.",
      ar: "ÿßŸÑÿπŸÜŸàÿßŸÜ ŸàÿßŸÑŸáÿßÿ™ŸÅ ŸàÿßŸÑÿ®ÿ±ŸäÿØ ÿßŸÑÿ•ŸÑŸÉÿ™ÿ±ŸàŸÜŸä.",
      tr: "Adres, telefon ve e-posta.",
      ps: "Ÿæÿ™Ÿáÿå Ÿº€åŸÑ€åŸÅŸàŸÜ ÿßŸà ÿ®ÿ±€ê⁄öŸÜÿßŸÑ€å⁄©.",
      ku: "ŸÜÿßŸàŸÜ€åÿ¥ÿßŸÜÿå ÿ™€ïŸÑ€ïŸÅ€ÜŸÜ Ÿà ÿ¶€åŸÖ€ï€å⁄µ.",
      ro: "AdresƒÉ, telefon »ôi e-mail.",
      ka: "·Éõ·Éò·É°·Éê·Éõ·Éê·É†·Éó·Éò, ·É¢·Éî·Éö·Éî·É§·Éù·Éú·Éò ·Éì·Éê ·Éî·Éö·É§·Éù·É°·É¢·Éê."
    },
    searchTitle: {
      fr: "Rechercher dans la FAQ",
      en: "Search the FAQ",
      ar: "ÿßŸÑÿ®ÿ≠ÿ´ ŸÅŸä ÿßŸÑÿ£ÿ≥ÿ¶ŸÑÿ© ÿßŸÑÿ¥ÿßÿ¶ÿπÿ©",
      tr: "SSS'de ara",
      ps: "ŸæŸá FAQ ⁄©€ê ŸÑŸºŸàŸÜ",
      ku: "⁄Ø€ï⁄ïÿßŸÜ ŸÑ€ï FAQ",
      ro: "CautƒÉ √Æn FAQ",
      ka: "·É´·Éò·Éî·Éë·Éê FAQ-·É®·Éò"
    },
    searchPlaceholder: {
      fr: "Rechercher‚Ä¶",
      en: "Search‚Ä¶",
      ar: "ÿßÿ®ÿ≠ÿ´‚Ä¶",
      tr: "Ara‚Ä¶",
      ps: "ŸàŸÑŸºŸàÿ¶‚Ä¶",
      ku: "ÿ®⁄Ø€ï⁄ï€é‚Ä¶",
      ro: "CautƒÉ‚Ä¶",
      ka: "·É´·Éò·Éî·Éë·Éê‚Ä¶"
    }
  };

  const applyStaticTexts = () => {
    if(els.heroKicker) els.heroKicker.textContent = t(UI_TEXT.heroKicker, els.heroKicker.textContent || '');
    if(els.heroTitle)  els.heroTitle.innerHTML   = t(UI_TEXT.heroTitleHtml, els.heroTitle.innerHTML || '');
    if(els.heroSubtitle) els.heroSubtitle.textContent = t(UI_TEXT.heroSubtitle, els.heroSubtitle.textContent || '');
    if(els.introTitle) els.introTitle.textContent = t(UI_TEXT.introTitle, els.introTitle.textContent || '');
    if(els.introDesc)  els.introDesc.textContent  = t(UI_TEXT.introDesc, els.introDesc.textContent || '');
    if(els.contactTitle) els.contactTitle.textContent = t(UI_TEXT.contactTitle, els.contactTitle.textContent || '');
    if(els.contactDesc)  els.contactDesc.textContent  = t(UI_TEXT.contactDesc, els.contactDesc.textContent || '');

    // Search UI
    const searchWrap = document.querySelector('.search');
    if(searchWrap) searchWrap.title = t(UI_TEXT.searchTitle, searchWrap.title || '');
    if(els.searchInput){
      els.searchInput.placeholder = t(UI_TEXT.searchPlaceholder, els.searchInput.placeholder || '');
    }
  };


  const makeBtn = (label, href, cls='btn') => {
    const a = document.createElement('a');
    a.className = cls;
    a.href = href;

    // If it's a local PDF, trigger direct download instead of opening a new tab
    const isLocalPdf = (typeof href === 'string') && (/\.pdf(\?|#|$)/i.test(href)) && !/^https?:\/\//i.test(href);
    if(isLocalPdf){
      a.download = '';
      a.target = '_self';
    } else {
      a.target = '_blank';
      a.rel = 'noopener';
    }

    a.textContent = label;
    return a;
  };

  function buildLangButtons(){
    if(!els.langButtons) return;
    els.langButtons.innerHTML = '';
    const langs = (faqData?.meta?.languages) || ['fr'];
    const labels = faqData?.meta?.lang_labels || {};
    const flags = { fr:'üá´üá∑', en:'üá¨üáß', ar:'üá∏üá¶', tr:'üáπüá∑', ps:'üá¶üá´', ku:'üáÆüá∂', ka:'üá¨üá™', ro:'üá∑üá¥' };
    langs.forEach(l => {
      const b = document.createElement('button');
      b.type = 'button';
      b.className = 'langBtn' + (l===lang ? ' active' : '');
      b.dataset.lang = l;
      b.innerHTML = `<span aria-hidden="true">${flags[l]||'üåê'}</span><span>${labels[l] || l}</span>`;
      b.addEventListener('click', () => setLanguage(l));
      els.langButtons.appendChild(b);
    });
  }

  function setLanguage(newLang){
    lang = newLang;
    applyDirection();
    applyStaticTexts();
    buildSidebar();
    renderHero();
    applyStaticTexts();
    renderIntro();
    renderFAQ();
    buildLangButtons();
  }

  function buildSidebar(){
    const sections = faqData?.sections || [];
    const items = faqData?.items || [];
    const counts = {};
    items.forEach(it => { counts[it.section] = (counts[it.section]||0)+1; });

    const allLabel = (lang === 'fr') ? 'Tout' :
                     (lang === 'en') ? 'All' :
                     (lang === 'ar') ? 'ÿßŸÑŸÉŸÑ' :
                     (lang === 'tr') ? 'T√ºm√º' :
                     (lang === 'ps') ? 'ŸºŸàŸÑ' :
                     (lang === 'ku') ? 'Hem√ª' :
                     (lang === 'ro') ? 'Toate' :
                     (lang === 'ka') ? '·Éß·Éï·Éî·Éö·Éê' : 'All';



    els.navList.innerHTML = '';
    const all = document.createElement('div');
    all.className = 'navItem' + (activeSection==='all'?' active':'');
    all.onclick = () => { activeSection='all'; renderFAQ(); buildSidebar(); };
    all.innerHTML = `<span>${allLabel}</span><span class="chip">${items.length}</span>`;
    els.navList.appendChild(all);

    sections.forEach(sec => {
      const id = sec.key || sec.id;
      const label = t(sec.title, id);
      const row = document.createElement('div');
      row.className = 'navItem' + (activeSection===id?' active':'');
      row.onclick = () => { activeSection=id; renderFAQ(); buildSidebar(); };
      row.innerHTML = `<span>${label}</span><span class="chip">${counts[id]||0}</span>`;
      els.navList.appendChild(row);
    });
  }

  function renderHero(){
    els.heroBtns.innerHTML = '';

    // Keep: official IDF website
    const idfUrl = introData?.official_idf?.site?.url;
    const idfLabel = t(introData?.official_idf?.site?.label, 'Site officiel ‚Äì Vaccination Coll√®ge √éle-de-France');
    if(idfUrl){
      els.heroBtns.appendChild(makeBtn(idfLabel, idfUrl, 'btn'));
    }

    // Add: 3 key videos next to the official site
    const vids = (introData?.resources?.videos || []).slice(0,3);
    vids.forEach(v => {
      /* ‚úÖ FIX VIDEO LABEL: title first, then label */
      const label = t(v.title, '') || t(v.label, 'Vid√©o');
      if(v?.url) els.heroBtns.appendChild(makeBtn(label, v.url, 'btn'));
    });
  }



  function renderIntro(){
    const root = els.introBody;
    root.innerHTML = '';

    // Logo if available
    const logoFile = normPath(introData?.branding?.service_logo?.file || introData?.branding?.logo?.file);
    const logoAlt = t(introData?.branding?.service_logo?.alt || introData?.branding?.logo?.alt, 'Logo');
    if(logoFile){
      const img = document.createElement('img');
      img.src = logoFile;
      img.alt = logoAlt;
      img.className = 'logoImg';
      root.appendChild(img);
    }

    // Intro text
    const introBlock = introData?.intro;
    if(introBlock){
      const title = document.createElement('div');
      title.style.fontWeight = '900';
      title.style.fontSize = '16px';
      title.textContent = t(introBlock.title, 'Introduction');
      root.appendChild(title);

      const body = document.createElement('div');
      body.className = 'note';
      body.style.fontSize = '13px';
      body.style.color = 'var(--text)';
      body.textContent = t(introBlock.body, '') || t(introBlock.text, '');
      root.appendChild(body);

      const sig = (typeof introBlock.signature === 'string') ? introBlock.signature : t(introBlock.signature, '');
      if(sig){
        const s = document.createElement('div');
        s.className = 'note';
        s.textContent = sig;
        root.appendChild(s);
      }
    }

    const group = document.createElement('div');
    group.className = 'resourceGroup';
    root.appendChild(group);

    const addBtn = (label, href) => group.appendChild(makeBtn(label, href, 'btn'));

    // Registration button (HPV + M√©ningite ACWY uniquement)
    const regUrl = introData?.registration?.url || introData?.registration?.online?.url;
    const regLabel = t(introData?.registration?.label || introData?.registration?.online?.label, 'Inscription en ligne (HPV + M√©ningite ACWY uniquement)');
    if(regUrl) addBtn(regLabel, regUrl);

    // Forms
    (introData?.resources?.forms || []).forEach(f => addBtn(t(f.label, 'Formulaire') || t(f.title, 'Formulaire'), f.url));
    // Existing videos
    (introData?.resources?.videos || []).forEach(v => addBtn(t(v.title, '') || t(v.label, 'Vid√©o'), v.url));
    // Existing email
    if(introData?.contact?.email) addBtn(introData.contact.email, `mailto:${introData.contact.email}`);

    // Additions (chef) ‚Äî optional
    if(introData?.official_idf?.flyer_pdf?.file){
      addBtn(t(introData.official_idf.flyer_pdf.label, 'Flyer officiel (PDF)'), normPath(introData.official_idf.flyer_pdf.file));
    }
    if(introData?.hpv_flyer_multilang?.url){
      addBtn(t(introData.hpv_flyer_multilang.label, 'Ressources HPV'), introData.hpv_flyer_multilang.url);
    }

    // Meningite documents
    if(introData?.meningite_documents){
      const mt = document.createElement('div');
      mt.style.marginTop = '14px';
      mt.style.fontWeight = '900';
      mt.textContent = t(introData.meningite_documents.label, 'M√©ningite ‚Äì documents');
      root.appendChild(mt);

      const mgroup = document.createElement('div');
      mgroup.className = 'resourceGroup';
      mgroup.style.marginTop = '10px';
      root.appendChild(mgroup);

      (introData.meningite_documents.items || []).forEach(it => {
        const a = makeBtn(t(it.label, 'Document'), normPath(it.file), 'btn');
        mgroup.appendChild(a);
      });

      const note = t(introData.meningite_documents.note, '');
      if(note){
        const n = document.createElement('div');
        n.className = 'note';
        n.textContent = note;
        root.appendChild(n);
      }
    }
  }

  function renderFAQ(){
    const q = (els.searchInput.value || '').trim().toLowerCase();
    const items = (faqData?.items || []).filter(it => {
      if(activeSection !== 'all' && it.section !== activeSection) return false;
      const question = safeText(t(it.q));
      const answer = safeText(t(it.a));
      const hay = (question + ' ' + answer).toLowerCase();
      if(!q) return true;
      return hay.includes(q);
    });

    els.faqTitle.textContent = t(faqData?.meta?.title, 'FAQ');
    const total = (faqData?.items || []).filter(it => activeSection==='all' ? true : it.section===activeSection).length;
    els.faqCount.textContent = `${items.length} / ${total}`;

    els.faqList.innerHTML = '';
    items.forEach(it => {
      const d = document.createElement('details');
      const s = document.createElement('summary');
      s.textContent = t(it.q, 'Question');
      const right = document.createElement('span');
      right.className = 'chip';
      const sec = (faqData?.sections || []).find(x => (x.key || x.id) === it.section);
      right.textContent = sec ? t(sec.title, it.section) : it.section;
      s.appendChild(right);

      const a = document.createElement('div');
      a.className = 'ans';
      a.textContent = t(it.a, '');

      d.appendChild(s);
      d.appendChild(a);

      els.faqList.appendChild(d);
    });
  }

  function applyDirection() {
    const rtlLangs = ['ar','ps','ku'];
    if (rtlLangs.includes(lang)) {
      document.body.classList.add('rtl');
      document.documentElement.setAttribute('dir','rtl');
    } else {
      document.body.classList.remove('rtl');
      document.documentElement.setAttribute('dir','ltr');
    }
  }

  async function init(){
    const [faqRes, introRes] = await Promise.all([
      fetch(FAQ_URL, {cache:'no-store'}),
      fetch(INTRO_URL, {cache:'no-store'})
    ]);
    faqData = await faqRes.json();
    introData = await introRes.json();

    // initial lang = first meta language if present
    const langs = faqData?.meta?.languages || ['fr'];
    lang = langs.includes('fr') ? 'fr' : langs[0];

    buildLangButtons();
    buildSidebar();
    renderHero();
    renderIntro();
    renderFAQ();
  }

  // Events
  els.burgerBtn.addEventListener('click', () => els.sidebar.classList.toggle('open'));
  els.searchInput.addEventListener('input', () => renderFAQ());
  document.addEventListener('click', (e) => {
    if(window.innerWidth <= 980){
      const inside = els.sidebar.contains(e.target) || els.burgerBtn.contains(e.target);
      if(!inside) els.sidebar.classList.remove('open');
    }
  });

  init().catch(err => {
    console.error(err);
    alert("Erreur de chargement des fichiers JSON. V√©rifiez que faq.json et intro_resources.json sont bien √† la racine du site.");
  });
/* ===== THEME TOGGLE ===== */
const toggle = document.getElementById('themeToggle');
const root = document.documentElement;

const savedTheme = localStorage.getItem('theme') || 'dark';
root.setAttribute('data-theme', savedTheme);
toggle.textContent = savedTheme === 'dark' ? '‚òÄÔ∏è' : 'üåô';

toggle.addEventListener('click', () => {
  const current = root.getAttribute('data-theme');
  const next = current === 'dark' ? 'light' : 'dark';
  root.setAttribute('data-theme', next);
  localStorage.setItem('theme', next);
  toggle.textContent = next === 'dark' ? '‚òÄÔ∏è' : 'üåô';
});
</script>
</body>
</html>
